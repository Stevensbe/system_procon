# Generated by Django 5.2.5 on 2025-08-17 19:41

import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='AgendamentoRelatorio',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nome_agendamento', models.CharField(max_length=100, verbose_name='Nome do Agendamento')),
                ('data_inicio', models.DateField(verbose_name='Data de Início')),
                ('data_fim', models.DateField(blank=True, null=True, verbose_name='Data de Fim')),
                ('frequencia', models.CharField(choices=[('diario', 'Diário'), ('semanal', 'Semanal'), ('mensal', 'Mensal'), ('trimestral', 'Trimestral'), ('anual', 'Anual'), ('personalizado', 'Personalizado')], max_length=20, verbose_name='Frequência')),
                ('dia_mes', models.IntegerField(blank=True, help_text='Para frequência mensal', null=True, verbose_name='Dia do Mês')),
                ('dia_semana', models.IntegerField(blank=True, help_text='0=segunda, 6=domingo', null=True, verbose_name='Dia da Semana')),
                ('horario', models.TimeField(verbose_name='Horário')),
                ('destinatarios', models.TextField(help_text='Um email por linha', verbose_name='Destinatários')),
                ('assunto_email', models.CharField(max_length=200, verbose_name='Assunto do Email')),
                ('corpo_email', models.TextField(blank=True, verbose_name='Corpo do Email')),
                ('ativo', models.BooleanField(default=True, verbose_name='Ativo')),
                ('incluir_anexo', models.BooleanField(default=True, verbose_name='Incluir Anexo')),
                ('formato_anexo', models.CharField(choices=[('pdf', 'PDF'), ('excel', 'Excel')], default='pdf', max_length=10, verbose_name='Formato Anexo')),
                ('criado_em', models.DateTimeField(auto_now_add=True, verbose_name='Criado em')),
                ('ultima_execucao', models.DateTimeField(blank=True, null=True, verbose_name='Última Execução')),
                ('proxima_execucao', models.DateTimeField(blank=True, null=True, verbose_name='Próxima Execução')),
            ],
            options={
                'verbose_name': 'Agendamento de Relatório',
                'verbose_name_plural': 'Agendamentos de Relatório',
                'ordering': ['proxima_execucao'],
            },
        ),
        migrations.CreateModel(
            name='CategoriaRelatorio',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nome', models.CharField(max_length=100, unique=True, verbose_name='Nome')),
                ('descricao', models.TextField(blank=True, verbose_name='Descrição')),
                ('icone', models.CharField(blank=True, help_text='Classe do ícone (ex: fa-chart-bar)', max_length=50, verbose_name='Ícone')),
                ('ativo', models.BooleanField(default=True, verbose_name='Ativo')),
                ('ordem', models.IntegerField(default=0, verbose_name='Ordem')),
            ],
            options={
                'verbose_name': 'Categoria de Relatório',
                'verbose_name_plural': 'Categorias de Relatório',
                'ordering': ['ordem', 'nome'],
            },
        ),
        migrations.CreateModel(
            name='DashboardPersonalizado',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nome', models.CharField(max_length=100, verbose_name='Nome')),
                ('descricao', models.TextField(blank=True, verbose_name='Descrição')),
                ('layout_colunas', models.IntegerField(choices=[(2, '2 Colunas'), (3, '3 Colunas'), (4, '4 Colunas')], default=3, verbose_name='Colunas')),
                ('altura_minima', models.IntegerField(default=400, verbose_name='Altura Mínima (px)')),
                ('publico', models.BooleanField(default=False, verbose_name='Público')),
                ('padrao', models.BooleanField(default=False, help_text='Dashboard padrão do sistema', verbose_name='Padrão')),
                ('auto_refresh', models.IntegerField(default=300, help_text='0 = desabilitado', verbose_name='Auto Refresh (seg)')),
                ('ativo', models.BooleanField(default=True, verbose_name='Ativo')),
                ('criado_por', models.CharField(max_length=100, verbose_name='Criado por')),
                ('criado_em', models.DateTimeField(auto_now_add=True, verbose_name='Criado em')),
            ],
            options={
                'verbose_name': 'Dashboard Personalizado',
                'verbose_name_plural': 'Dashboards Personalizados',
                'ordering': ['nome'],
            },
        ),
        migrations.CreateModel(
            name='DashboardKPI',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('posicao_linha', models.IntegerField(default=1, verbose_name='Linha')),
                ('posicao_coluna', models.IntegerField(default=1, verbose_name='Coluna')),
                ('largura', models.IntegerField(default=1, help_text='Quantas colunas ocupar', verbose_name='Largura')),
                ('altura', models.IntegerField(default=1, help_text='Quantas linhas ocupar', verbose_name='Altura')),
                ('dashboard', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='relatorios.dashboardpersonalizado')),
            ],
            options={
                'verbose_name': 'KPI do Dashboard',
                'verbose_name_plural': 'KPIs do Dashboard',
                'ordering': ['posicao_linha', 'posicao_coluna'],
            },
        ),
        migrations.CreateModel(
            name='IndicadorKPI',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nome', models.CharField(max_length=100, verbose_name='Nome')),
                ('descricao', models.TextField(blank=True, verbose_name='Descrição')),
                ('modelo_base', models.CharField(max_length=100, verbose_name='Modelo Base')),
                ('campo_calculo', models.CharField(blank=True, max_length=100, verbose_name='Campo de Cálculo')),
                ('tipo_calculo', models.CharField(choices=[('count', 'Contagem'), ('sum', 'Soma'), ('avg', 'Média'), ('max', 'Máximo'), ('min', 'Mínimo'), ('custom', 'Personalizado')], default='count', max_length=20, verbose_name='Tipo de Cálculo')),
                ('filtros_kpi', models.TextField(blank=True, help_text='JSON com filtros específicos', verbose_name='Filtros')),
                ('formato', models.CharField(choices=[('numero', 'Número'), ('moeda', 'Moeda'), ('porcentagem', 'Porcentagem'), ('data', 'Data')], default='numero', max_length=20, verbose_name='Formato')),
                ('prefixo', models.CharField(blank=True, max_length=10, verbose_name='Prefixo')),
                ('sufixo', models.CharField(blank=True, max_length=10, verbose_name='Sufixo')),
                ('casas_decimais', models.IntegerField(default=0, verbose_name='Casas Decimais')),
                ('meta_valor', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Valor Meta')),
                ('comparar_periodo_anterior', models.BooleanField(default=True, verbose_name='Comparar com Período Anterior')),
                ('icone', models.CharField(blank=True, max_length=50, verbose_name='Ícone')),
                ('cor_primaria', models.CharField(default='#007bff', max_length=7, verbose_name='Cor Primária')),
                ('cor_secundaria', models.CharField(default='#6c757d', max_length=7, verbose_name='Cor Secundária')),
                ('ativo', models.BooleanField(default=True, verbose_name='Ativo')),
                ('ordem', models.IntegerField(default=0, verbose_name='Ordem')),
                ('cache_duration', models.IntegerField(default=30, verbose_name='Duração Cache (min)')),
                ('valor_cache', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Valor em Cache')),
                ('cache_atualizado_em', models.DateTimeField(blank=True, null=True, verbose_name='Cache Atualizado')),
                ('categoria', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='relatorios.categoriarelatorio', verbose_name='Categoria')),
            ],
            options={
                'verbose_name': 'Indicador KPI',
                'verbose_name_plural': 'Indicadores KPI',
                'ordering': ['categoria__ordem', 'ordem', 'nome'],
            },
        ),
        migrations.AddField(
            model_name='dashboardpersonalizado',
            name='kpis',
            field=models.ManyToManyField(through='relatorios.DashboardKPI', to='relatorios.indicadorkpi', verbose_name='KPIs'),
        ),
        migrations.AddField(
            model_name='dashboardkpi',
            name='kpi',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='relatorios.indicadorkpi'),
        ),
        migrations.CreateModel(
            name='RelatorioPersonalizado',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nome', models.CharField(max_length=150, verbose_name='Nome')),
                ('descricao', models.TextField(blank=True, verbose_name='Descrição')),
                ('tipo', models.CharField(choices=[('dashboard', 'Dashboard'), ('tabular', 'Tabular'), ('grafico', 'Gráfico'), ('pdf', 'PDF'), ('excel', 'Excel')], default='tabular', max_length=20, verbose_name='Tipo')),
                ('modelo_base', models.CharField(help_text='Ex: multas.Multa, fiscalizacao.Processo', max_length=100, verbose_name='Modelo Base')),
                ('campos_selecionados', models.TextField(help_text='JSON com campos e filtros', verbose_name='Campos Selecionados')),
                ('filtros_padrao', models.TextField(blank=True, help_text='JSON com filtros padrão', verbose_name='Filtros Padrão')),
                ('periodo_padrao', models.CharField(choices=[('diario', 'Diário'), ('semanal', 'Semanal'), ('mensal', 'Mensal'), ('trimestral', 'Trimestral'), ('anual', 'Anual'), ('personalizado', 'Personalizado')], default='mensal', max_length=20, verbose_name='Período Padrão')),
                ('titulo', models.CharField(max_length=200, verbose_name='Título')),
                ('subtitulo', models.CharField(blank=True, max_length=200, verbose_name='Subtítulo')),
                ('largura_colunas', models.TextField(blank=True, help_text='JSON com larguras', verbose_name='Largura das Colunas')),
                ('cores_personalizadas', models.TextField(blank=True, help_text='JSON com cores', verbose_name='Cores Personalizadas')),
                ('agendado', models.BooleanField(default=False, verbose_name='Agendado')),
                ('frequencia_agendamento', models.CharField(blank=True, choices=[('diario', 'Diário'), ('semanal', 'Semanal'), ('mensal', 'Mensal'), ('trimestral', 'Trimestral'), ('anual', 'Anual'), ('personalizado', 'Personalizado')], max_length=20, verbose_name='Frequência')),
                ('horario_envio', models.TimeField(blank=True, null=True, verbose_name='Horário de Envio')),
                ('destinatarios_email', models.TextField(blank=True, help_text='Um email por linha', verbose_name='Destinatários Email')),
                ('ativo', models.BooleanField(default=True, verbose_name='Ativo')),
                ('publico', models.BooleanField(default=False, help_text='Visível para todos os usuários', verbose_name='Público')),
                ('criado_por', models.CharField(max_length=100, verbose_name='Criado por')),
                ('criado_em', models.DateTimeField(auto_now_add=True, verbose_name='Criado em')),
                ('atualizado_em', models.DateTimeField(auto_now=True, verbose_name='Atualizado em')),
                ('visualizacoes', models.IntegerField(default=0, verbose_name='Visualizações')),
                ('ultima_execucao', models.DateTimeField(blank=True, null=True, verbose_name='Última Execução')),
                ('tempo_execucao_medio', models.DecimalField(blank=True, decimal_places=3, max_digits=10, null=True, verbose_name='Tempo Médio (s)')),
                ('categoria', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='relatorios.categoriarelatorio', verbose_name='Categoria')),
            ],
            options={
                'verbose_name': 'Relatório Personalizado',
                'verbose_name_plural': 'Relatórios Personalizados',
                'ordering': ['categoria__ordem', 'nome'],
            },
        ),
        migrations.CreateModel(
            name='LogExecucaoRelatorio',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('data_inicio', models.DateTimeField(auto_now_add=True, verbose_name='Início')),
                ('data_fim', models.DateTimeField(blank=True, null=True, verbose_name='Fim')),
                ('tempo_execucao', models.DecimalField(blank=True, decimal_places=3, max_digits=10, null=True, verbose_name='Tempo (seg)')),
                ('status', models.CharField(choices=[('sucesso', 'Sucesso'), ('erro', 'Erro'), ('timeout', 'Timeout')], max_length=20, verbose_name='Status')),
                ('parametros_execucao', models.TextField(blank=True, help_text='JSON com parâmetros usados', verbose_name='Parâmetros')),
                ('registros_retornados', models.IntegerField(blank=True, null=True, verbose_name='Registros Retornados')),
                ('tamanho_arquivo', models.IntegerField(blank=True, null=True, verbose_name='Tamanho Arquivo (bytes)')),
                ('erro_detalhes', models.TextField(blank=True, verbose_name='Detalhes do Erro')),
                ('executado_por', models.CharField(blank=True, max_length=100, verbose_name='Executado por')),
                ('agendamento', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='relatorios.agendamentorelatorio')),
                ('relatorio', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='logs_execucao', to='relatorios.relatoriopersonalizado')),
            ],
            options={
                'verbose_name': 'Log de Execução',
                'verbose_name_plural': 'Logs de Execução',
                'ordering': ['-data_inicio'],
            },
        ),
        migrations.CreateModel(
            name='DashboardRelatorio',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('posicao_linha', models.IntegerField(default=1, verbose_name='Linha')),
                ('posicao_coluna', models.IntegerField(default=1, verbose_name='Coluna')),
                ('largura', models.IntegerField(default=2, verbose_name='Largura')),
                ('altura', models.IntegerField(default=2, verbose_name='Altura')),
                ('dashboard', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='relatorios.dashboardpersonalizado')),
                ('relatorio', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='relatorios.relatoriopersonalizado')),
            ],
            options={
                'verbose_name': 'Relatório do Dashboard',
                'verbose_name_plural': 'Relatórios do Dashboard',
                'ordering': ['posicao_linha', 'posicao_coluna'],
            },
        ),
        migrations.AddField(
            model_name='dashboardpersonalizado',
            name='relatorios',
            field=models.ManyToManyField(through='relatorios.DashboardRelatorio', to='relatorios.relatoriopersonalizado', verbose_name='Relatórios'),
        ),
        migrations.AddField(
            model_name='agendamentorelatorio',
            name='relatorio',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='relatorios.relatoriopersonalizado', verbose_name='Relatório'),
        ),
        migrations.AlterUniqueTogether(
            name='dashboardkpi',
            unique_together={('dashboard', 'posicao_linha', 'posicao_coluna')},
        ),
    ]
