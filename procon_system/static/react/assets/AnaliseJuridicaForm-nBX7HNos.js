import{j as e}from"./main-QkSqPps8.js";import{u as L,e as R,r as i}from"./router-C15yhWin.js";import{a as c}from"./analiseJuridicaService-BlWiycQg.js";import{n as t}from"./index-CsOmCsbp.js";import{L as g}from"./LoadingSpinner-CioJYzaJ.js";import{F as _}from"./ArrowLeftIcon-B1Aara0h.js";import{F as I}from"./XMarkIcon-C8R2LFm1.js";import{F}from"./DocumentCheckIcon-CEHDhKx0.js";import"./vendor-Csw2ODfV.js";import"./icons-C8WIGuh4.js";const G=()=>{const d=L(),{id:n}=R(),[f,u]=i.useState(!1),[x,b]=i.useState(!1),[h,v]=i.useState([]),[j,y]=i.useState([]),[s,m]=i.useState({titulo:"",descricao:"",processo:"",analista:"",tipo_analise:"",prioridade:"NORMAL",prazo:"",observacoes:"",documentos_anexos:[]}),N=[{value:"CONSULTIVA",label:"Consultiva"},{value:"RECURSAL",label:"Recursal"},{value:"ADMINISTRATIVA",label:"Administrativa"},{value:"LEGISLATIVA",label:"Legislativa"},{value:"JUDICIAL",label:"Judicial"}],A=[{value:"BAIXA",label:"Baixa",color:"text-green-600"},{value:"NORMAL",label:"Normal",color:"text-blue-600"},{value:"ALTA",label:"Alta",color:"text-orange-600"},{value:"URGENTE",label:"Urgente",color:"text-red-600"}];i.useEffect(()=>{w(),n&&C()},[n]);const w=async()=>{try{u(!0);const a=await c.listarAnalistas();v(a);const r=await c.listarProcessos();y(r)}catch(a){console.error("Erro ao carregar dados iniciais:",a),t.error("Erro ao carregar dados iniciais")}finally{u(!1)}},C=async()=>{try{u(!0);const a=await c.obterAnalise(n);m(a)}catch(a){console.error("Erro ao carregar análise:",a),t.error("Erro ao carregar análise"),d("/analise-juridica")}finally{u(!1)}},l=a=>{const{name:r,value:o}=a.target;m(p=>({...p,[r]:o}))},S=a=>{const r=Array.from(a.target.files);m(o=>({...o,documentos_anexos:[...o.documentos_anexos,...r]}))},E=a=>{m(r=>({...r,documentos_anexos:r.documentos_anexos.filter((o,p)=>p!==a)}))},D=()=>{const a=[];return s.titulo.trim()||a.push("Título é obrigatório"),s.descricao.trim()||a.push("Descrição é obrigatória"),s.processo||a.push("Processo é obrigatório"),s.analista||a.push("Analista é obrigatório"),s.tipo_analise||a.push("Tipo de análise é obrigatório"),s.prazo||a.push("Prazo é obrigatório"),a},k=async a=>{a.preventDefault();const r=D();if(r.length>0){r.forEach(o=>t.error(o));return}try{b(!0),n?(await c.atualizarAnalise(n,s),t.success("Análise atualizada com sucesso!")):(await c.criarAnalise(s),t.success("Análise criada com sucesso!")),d("/analise-juridica")}catch(o){console.error("Erro ao salvar análise:",o),t.error("Erro ao salvar análise")}finally{b(!1)}};return f?e.jsx(g,{}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>d("/analise-juridica"),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(_,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n?"Editar Análise Jurídica":"Nova Análise Jurídica"}),e.jsx("p",{className:"text-gray-600",children:n?"Edite os dados da análise jurídica":"Crie uma nova análise jurídica"})]})]})})}),e.jsxs("form",{onSubmit:k,className:"bg-white shadow-lg rounded-lg p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Título da Análise *"}),e.jsx("input",{type:"text",name:"titulo",value:s.titulo,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Digite o título da análise",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Processo *"}),e.jsxs("select",{name:"processo",value:s.processo,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Selecione um processo"}),j.map(a=>e.jsxs("option",{value:a.id,children:[a.numero," - ",a.titulo]},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Analista Responsável *"}),e.jsxs("select",{name:"analista",value:s.analista,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Selecione um analista"}),h.map(a=>e.jsxs("option",{value:a.id,children:[a.nome," - ",a.especialidade]},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Análise *"}),e.jsxs("select",{name:"tipo_analise",value:s.tipo_analise,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Selecione o tipo"}),N.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prioridade"}),e.jsx("select",{name:"prioridade",value:s.prioridade,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:A.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prazo *"}),e.jsx("input",{type:"date",name:"prazo",value:s.prazo,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição *"}),e.jsx("textarea",{name:"descricao",value:s.descricao,onChange:l,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Descreva os detalhes da análise jurídica",required:!0})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações"}),e.jsx("textarea",{name:"observacoes",value:s.observacoes,onChange:l,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Observações adicionais"})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Documentos Anexos"}),e.jsx("input",{type:"file",multiple:!0,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png"}),s.documentos_anexos.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:s.documentos_anexos.map((a,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm text-gray-700",children:a.name}),e.jsx("button",{type:"button",onClick:()=>E(r),className:"text-red-500 hover:text-red-700",children:e.jsx(I,{className:"h-4 w-4"})})]},r))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>d("/analise-juridica"),className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:x,className:"px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[x?e.jsx(g,{size:"sm"}):e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{children:x?"Salvando...":"Salvar Análise"})]})]})]})]})})};export{G as default};
