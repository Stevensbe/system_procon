import{j as e}from"./main-CRMJS0Wv.js";import{u as F,r as l,L as h}from"./router-Cgdj9vyr.js";import{F as R}from"./ArrowLeftIcon-C_0pt37t.js";import{F as p}from"./DocumentTextIcon-B0GYMzL8.js";import{F as d}from"./ExclamationTriangleIcon-2kHM3Vz3.js";import{F as C}from"./BuildingOfficeIcon-B2iC5QD_.js";import{F as E}from"./ScaleIcon-CDQgDKJ-.js";import{F as A}from"./UserGroupIcon-DY3obWR_.js";import{F as D}from"./CurrencyDollarIcon-BYymgR5k.js";import{F as c}from"./CalendarIcon-DKD9rodC.js";import{F as z}from"./DocumentChartBarIcon-BebhM3vK.js";import{F as S}from"./FunnelIcon-C9OgRzwO.js";import{F as $}from"./ClockIcon-CMrA9XuO.js";import{F as _}from"./DocumentArrowDownIcon-CaS0chxy.js";import"./vendor-Csw2ODfV.js";import"./icons-qiKTog5F.js";const Z=()=>{const f=F(),[T,P]=l.useState(!1),[n,m]=l.useState(!1),[a,u]=l.useState({titulo:"",modulo:"",tipo:"",periodo:{inicio:"",fim:""},formato:"PDF",incluirGraficos:!0,incluirTabelas:!0,incluirResumo:!0,filtros:{status:"",responsavel:"",departamento:"",categoria:""},agendamento:{ativo:!1,frequencia:"mensal",proximaExecucao:""},observacoes:""}),[s,x]=l.useState({}),g=[{id:"fiscalizacao",nome:"Fiscalização",icon:C,descricao:"Relatórios de autos de infração, fiscalizações e multas",tipos:[{id:"autos_infracao",nome:"Autos de Infração",descricao:"Relatório detalhado de autos de infração"},{id:"fiscalizacoes_mes",nome:"Fiscalizações do Mês",descricao:"Resumo mensal de fiscalizações realizadas"},{id:"multas_cobranca",nome:"Multas e Cobranças",descricao:"Análise de multas aplicadas e cobranças"},{id:"performance_fiscais",nome:"Performance dos Fiscais",descricao:"Métricas de performance dos fiscais"}]},{id:"juridico",nome:"Jurídico",icon:E,descricao:"Relatórios de processos jurídicos e análises",tipos:[{id:"processos_status",nome:"Processos por Status",descricao:"Análise de processos por status atual"},{id:"analises_juridicas",nome:"Análises Jurídicas",descricao:"Relatório de análises jurídicas realizadas"},{id:"prazos_vencimento",nome:"Prazos de Vencimento",descricao:"Controle de prazos de vencimento"},{id:"performance_analistas",nome:"Performance dos Analistas",descricao:"Métricas de performance dos analistas"}]},{id:"usuarios",nome:"Usuários",icon:A,descricao:"Relatórios de usuários e acessos ao sistema",tipos:[{id:"usuarios_ativos",nome:"Usuários Ativos",descricao:"Relatório de usuários ativos no sistema"},{id:"acessos_sistema",nome:"Acessos ao Sistema",descricao:"Análise de acessos e uso do sistema"},{id:"performance_usuarios",nome:"Performance de Usuários",descricao:"Métricas de performance dos usuários"},{id:"auditoria_acessos",nome:"Auditoria de Acessos",descricao:"Relatório de auditoria de acessos"}]},{id:"financeiro",nome:"Financeiro",icon:D,descricao:"Relatórios financeiros e contábeis",tipos:[{id:"receitas_despesas",nome:"Receitas e Despesas",descricao:"Análise de receitas e despesas"},{id:"multas_recebidas",nome:"Multas Recebidas",descricao:"Relatório de multas recebidas"},{id:"orcamento_execucao",nome:"Orçamento e Execução",descricao:"Controle de orçamento e execução"},{id:"fluxo_caixa",nome:"Fluxo de Caixa",descricao:"Análise do fluxo de caixa"}]}],y=[{id:"PDF",nome:"PDF",descricao:"Documento PDF (recomendado)"},{id:"EXCEL",nome:"Excel",descricao:"Planilha Excel (.xlsx)"},{id:"CSV",nome:"CSV",descricao:"Arquivo CSV (dados brutos)"}],j=[{id:"unica",nome:"Execução Única",descricao:"Executar apenas uma vez"},{id:"diaria",nome:"Diária",descricao:"Executar todos os dias"},{id:"semanal",nome:"Semanal",descricao:"Executar uma vez por semana"},{id:"mensal",nome:"Mensal",descricao:"Executar uma vez por mês"},{id:"trimestral",nome:"Trimestral",descricao:"Executar a cada 3 meses"}],o=(r,t)=>{if(r.includes(".")){const[i,N]=r.split(".");u(b=>({...b,[i]:{...b[i],[N]:t}}))}else u(i=>({...i,[r]:t}));s[r]&&x(i=>({...i,[r]:""}))},v=()=>{const r={};return a.titulo.trim()||(r.titulo="Título é obrigatório"),a.modulo||(r.modulo="Módulo é obrigatório"),a.tipo||(r.tipo="Tipo de relatório é obrigatório"),a.periodo.inicio||(r["periodo.inicio"]="Data de início é obrigatória"),a.periodo.fim||(r["periodo.fim"]="Data de fim é obrigatória"),a.periodo.inicio&&a.periodo.fim&&new Date(a.periodo.inicio)>new Date(a.periodo.fim)&&(r["periodo.fim"]="Data de fim deve ser posterior à data de início"),a.agendamento.ativo&&!a.agendamento.proximaExecucao&&(r["agendamento.proximaExecucao"]="Data da próxima execução é obrigatória"),x(r),Object.keys(r).length===0},k=async r=>{if(r.preventDefault(),!!v()){m(!0);try{await new Promise(t=>setTimeout(t,3e3)),f("/relatorios/lista")}catch(t){console.error("Erro ao gerar relatório:",t)}finally{m(!1)}}},w=r=>{const t=g.find(i=>i.id===r);return t?t.tipos:[]};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(h,{to:"/relatorios/lista",className:"mr-4 p-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(R,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Gerar Relatório"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-1",children:"Configure e gere um novo relatório personalizado"})]})]})})}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(p,{className:"h-6 w-6 text-blue-600 dark:text-blue-400 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Informações Básicas"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Título do Relatório *"}),e.jsx("input",{type:"text",value:a.titulo,onChange:r=>o("titulo",r.target.value),className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s.titulo?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`,placeholder:"Ex: Relatório de Fiscalização - Junho 2024"}),s.titulo&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400 flex items-center",children:[e.jsx(d,{className:"h-4 w-4 mr-1"}),s.titulo]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Módulo *"}),e.jsxs("select",{value:a.modulo,onChange:r=>{o("modulo",r.target.value),o("tipo","")},className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s.modulo?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`,children:[e.jsx("option",{value:"",children:"Selecione um módulo..."}),g.map(r=>e.jsx("option",{value:r.id,children:r.nome},r.id))]}),s.modulo&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400 flex items-center",children:[e.jsx(d,{className:"h-4 w-4 mr-1"}),s.modulo]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Tipo de Relatório *"}),e.jsxs("select",{value:a.tipo,onChange:r=>o("tipo",r.target.value),disabled:!a.modulo,className:`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s.tipo?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed`,children:[e.jsx("option",{value:"",children:a.modulo?"Selecione um tipo...":"Selecione um módulo primeiro"}),a.modulo&&w(a.modulo).map(r=>e.jsx("option",{value:r.id,children:r.nome},r.id))]}),s.tipo&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400 flex items-center",children:[e.jsx(d,{className:"h-4 w-4 mr-1"}),s.tipo]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Data de Início *"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"date",value:a.periodo.inicio,onChange:r=>o("periodo.inicio",r.target.value),className:`w-full pl-10 pr-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s["periodo.inicio"]?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`})]}),s["periodo.inicio"]&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400 flex items-center",children:[e.jsx(d,{className:"h-4 w-4 mr-1"}),s["periodo.inicio"]]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Data de Fim *"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"date",value:a.periodo.fim,onChange:r=>o("periodo.fim",r.target.value),className:`w-full pl-10 pr-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s["periodo.fim"]?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`})]}),s["periodo.fim"]&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400 flex items-center",children:[e.jsx(d,{className:"h-4 w-4 mr-1"}),s["periodo.fim"]]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(z,{className:"h-6 w-6 text-green-600 dark:text-green-400 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Configurações do Relatório"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Formato de Saída"}),e.jsx("select",{value:a.formato,onChange:r=>o("formato",r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:y.map(r=>e.jsx("option",{value:r.id,children:r.nome},r.id))})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"incluirGraficos",checked:a.incluirGraficos,onChange:r=>o("incluirGraficos",r.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"incluirGraficos",className:"ml-2 block text-sm text-gray-900 dark:text-white",children:"Incluir Gráficos"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"incluirTabelas",checked:a.incluirTabelas,onChange:r=>o("incluirTabelas",r.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"incluirTabelas",className:"ml-2 block text-sm text-gray-900 dark:text-white",children:"Incluir Tabelas"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"incluirResumo",checked:a.incluirResumo,onChange:r=>o("incluirResumo",r.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"incluirResumo",className:"ml-2 block text-sm text-gray-900 dark:text-white",children:"Incluir Resumo Executivo"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(S,{className:"h-6 w-6 text-purple-600 dark:text-purple-400 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Filtros Adicionais"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{value:a.filtros.status,onChange:r=>o("filtros.status",r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Todos os status"}),e.jsx("option",{value:"ativo",children:"Ativo"}),e.jsx("option",{value:"inativo",children:"Inativo"}),e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"concluido",children:"Concluído"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Responsável"}),e.jsx("input",{type:"text",value:a.filtros.responsavel,onChange:r=>o("filtros.responsavel",r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Nome do responsável"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Departamento"}),e.jsxs("select",{value:a.filtros.departamento,onChange:r=>o("filtros.departamento",r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"Todos os departamentos"}),e.jsx("option",{value:"fiscalizacao",children:"Fiscalização"}),e.jsx("option",{value:"juridico",children:"Jurídico"}),e.jsx("option",{value:"administrativo",children:"Administrativo"}),e.jsx("option",{value:"financeiro",children:"Financeiro"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Categoria"}),e.jsx("input",{type:"text",value:a.filtros.categoria,onChange:r=>o("filtros.categoria",r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Categoria específica"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx($,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Agendamento (Opcional)"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"agendamentoAtivo",checked:a.agendamento.ativo,onChange:r=>o("agendamento.ativo",r.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"agendamentoAtivo",className:"ml-2 block text-sm text-gray-900 dark:text-white",children:"Agendar execução automática"})]}),a.agendamento.ativo&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Frequência"}),e.jsx("select",{value:a.agendamento.frequencia,onChange:r=>o("agendamento.frequencia",r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:j.map(r=>e.jsx("option",{value:r.id,children:r.nome},r.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Próxima Execução *"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"datetime-local",value:a.agendamento.proximaExecucao,onChange:r=>o("agendamento.proximaExecucao",r.target.value),className:`w-full pl-10 pr-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s["agendamento.proximaExecucao"]?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600"} bg-white dark:bg-gray-700 text-gray-900 dark:text-white`})]}),s["agendamento.proximaExecucao"]&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400 flex items-center",children:[e.jsx(d,{className:"h-4 w-4 mr-1"}),s["agendamento.proximaExecucao"]]})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(p,{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Observações"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Observações Adicionais"}),e.jsx("textarea",{value:a.observacoes,onChange:r=>o("observacoes",r.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Informações adicionais sobre o relatório..."})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[e.jsx(h,{to:"/relatorios/lista",className:"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:n,className:"flex items-center px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Gerando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Gerar Relatório"]})})]})]})]})};export{Z as default};
