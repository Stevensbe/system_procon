import{r as n}from"./router-Cgdj9vyr.js";import{F as e}from"./main-CRMJS0Wv.js";function p({title:c,titleId:r,...o},t){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},o),c?n.createElement("title",{id:r},c):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z"}))}const l=n.forwardRef(p);class u{async obterEstatisticas(){try{return(await e.get("/auditoria/dashboard/")).data.stats}catch(r){throw console.error("Erro ao obter estatísticas de auditoria:",r),r}}async listarLogs(r={}){try{const o=new URLSearchParams;return r.search&&o.append("search",r.search),r.nivel&&o.append("nivel",r.nivel),r.tipo_evento&&o.append("tipo_evento",r.tipo_evento),r.usuario&&o.append("usuario",r.usuario),r.data_inicio&&o.append("data_inicio",r.data_inicio),r.data_fim&&o.append("data_fim",r.data_fim),r.modulo&&o.append("modulo",r.modulo),r.sucesso!==void 0&&o.append("sucesso",r.sucesso),r.page&&o.append("page",r.page),r.page_size&&o.append("page_size",r.page_size),(await e.get(`/auditoria/logs/?${o.toString()}`)).data}catch(o){throw console.error("Erro ao listar logs:",o),o}}async obterLog(r){try{return(await e.get(`/auditoria/logs/${r}/`)).data}catch(o){throw console.error("Erro ao obter log:",o),o}}async obterLogsPorNivel(){try{return(await e.get("/auditoria/logs-por-nivel/")).data}catch(r){throw console.error("Erro ao obter logs por nível:",r),r}}async obterEventosFrequentes(){try{return(await e.get("/auditoria/eventos-frequentes/")).data}catch(r){throw console.error("Erro ao obter eventos frequentes:",r),r}}async obterLogsCriticos(){try{return(await e.get("/auditoria/logs-criticos/")).data}catch(r){throw console.error("Erro ao obter logs críticos:",r),r}}async obterLogsRecentes(){try{return(await e.get("/auditoria/logs-recentes/")).data}catch(r){throw console.error("Erro ao obter logs recentes:",r),r}}async filtrarLogs(r){try{const o=new URLSearchParams;return Object.keys(r).forEach(a=>{r[a]&&o.append(a,r[a])}),(await e.get(`/auditoria/filtrar/?${o.toString()}`)).data}catch(o){throw console.error("Erro ao filtrar logs:",o),o}}async listarTiposEvento(){try{return(await e.get("/auditoria/tipos-evento/")).data}catch(r){throw console.error("Erro ao listar tipos de evento:",r),r}}async obterTipoEvento(r){try{return(await e.get(`/auditoria/tipos-evento/${r}/`)).data}catch(o){throw console.error("Erro ao obter tipo de evento:",o),o}}async criarTipoEvento(r){try{return(await e.post("/auditoria/tipos-evento/",r)).data}catch(o){throw console.error("Erro ao criar tipo de evento:",o),o}}async atualizarTipoEvento(r,o){try{return(await e.put(`/auditoria/tipos-evento/${r}/`,o)).data}catch(t){throw console.error("Erro ao atualizar tipo de evento:",t),t}}async excluirTipoEvento(r){try{await e.delete(`/auditoria/tipos-evento/${r}/`)}catch(o){throw console.error("Erro ao excluir tipo de evento:",o),o}}async exportarLogs(r={}){try{const o=new URLSearchParams;Object.keys(r).forEach(i=>{r[i]&&o.append(i,r[i])});const t=await e.get(`/auditoria/exportar/?${o.toString()}`,{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");return s.href=a,s.setAttribute("download",`auditoria_logs_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(a),!0}catch(o){throw console.error("Erro ao exportar logs:",o),o}}async gerarRelatorio(r){try{return(await e.post("/auditoria/relatorios/",r)).data}catch(o){throw console.error("Erro ao gerar relatório:",o),o}}async obterRelatorios(){try{return(await e.get("/auditoria/relatorios/")).data}catch(r){throw console.error("Erro ao obter relatórios:",r),r}}async obterConfiguracoes(){try{return(await e.get("/auditoria/configuracoes/")).data}catch(r){throw console.error("Erro ao obter configurações:",r),r}}async atualizarConfiguracoes(r){try{return(await e.put("/auditoria/configuracoes/",r)).data}catch(o){throw console.error("Erro ao atualizar configurações:",o),o}}async listarLogsSeguranca(r={}){try{const o=new URLSearchParams;return Object.keys(r).forEach(a=>{r[a]&&o.append(a,r[a])}),(await e.get(`/auditoria/logs-seguranca/?${o.toString()}`)).data}catch(o){throw console.error("Erro ao listar logs de segurança:",o),o}}async obterEstatisticasSeguranca(){try{return(await e.get("/auditoria/estatisticas-seguranca/")).data}catch(r){throw console.error("Erro ao obter estatísticas de segurança:",r),r}}async listarSessoesUsuario(r={}){try{const o=new URLSearchParams;return Object.keys(r).forEach(a=>{r[a]&&o.append(a,r[a])}),(await e.get(`/auditoria/sessoes-usuario/?${o.toString()}`)).data}catch(o){throw console.error("Erro ao listar sessões de usuário:",o),o}}async encerrarSessao(r){try{await e.post(`/auditoria/sessoes-usuario/${r}/encerrar/`)}catch(o){throw console.error("Erro ao encerrar sessão:",o),o}}async listarLogsBackup(){try{return(await e.get("/auditoria/logs-backup/")).data}catch(r){throw console.error("Erro ao listar logs de backup:",r),r}}async iniciarBackup(r){try{return(await e.post("/auditoria/backup/",r)).data}catch(o){throw console.error("Erro ao iniciar backup:",o),o}}async restaurarBackup(r){try{return(await e.post(`/auditoria/backup/${r}/restaurar/`)).data}catch(o){throw console.error("Erro ao restaurar backup:",o),o}}async limparLogsAntigos(r=90){try{return(await e.post("/auditoria/limpar-logs/",{dias:r})).data}catch(o){throw console.error("Erro ao limpar logs antigos:",o),o}}validarDadosLog(r){const o=[];return r.acao||o.push("Ação é obrigatória"),r.descricao||o.push("Descrição é obrigatória"),r.nivel||o.push("Nível é obrigatório"),o}formatarNivel(r){return{CRITICAL:"Crítico",ERROR:"Erro",WARNING:"Aviso",INFO:"Informação",DEBUG:"Debug"}[r]||r}formatarCategoria(r){return{sistema:"Sistema",usuario:"Usuário",processo:"Processo",financeiro:"Financeiro",fiscalizacao:"Fiscalização",seguranca:"Segurança"}[r]||r}formatarDataHora(r){return new Date(r).toLocaleString("pt-BR")}formatarDuracao(r){return r?r<1e3?`${r}ms`:`${(r/1e3).toFixed(2)}s`:"N/A"}isLogCritico(r){return r.nivel==="CRITICAL"||r.nivel==="ERROR"}isLogSeguranca(r){var o;return((o=r.tipo_evento)==null?void 0:o.categoria)==="seguranca"}getNivelColor(r){return{CRITICAL:"#dc2626",ERROR:"#ea580c",WARNING:"#d97706",INFO:"#059669",DEBUG:"#3b82f6"}[r]||"#6b7280"}}const h=new u;export{l as F,h as a};
