import{j as e}from"./main-QkSqPps8.js";import{r as n,L as g}from"./router-C15yhWin.js";import{t as v}from"./tramitacaoService-CkXA3AJE.js";import{n as _}from"./index-CsOmCsbp.js";import{F as $}from"./ArrowPathIcon-DvGuXmm8.js";import{F as z}from"./PlusIcon-DZYmRjce.js";import{F as P}from"./MagnifyingGlassIcon-DxjVcYIb.js";import{F as I}from"./FunnelIcon-PU3yDtaQ.js";import{F as M}from"./EyeIcon-Cu0Wnbis.js";import{F as B}from"./PencilIcon-CajHx5Rb.js";import{F as L}from"./TrashIcon-CKnVykBy.js";import{F as V}from"./ChevronLeftIcon-DrI7nw9R.js";import{F as q}from"./ChevronRightIcon-BTrjiRa8.js";import{F as G}from"./DocumentArrowDownIcon-Bp61FGwk.js";import{F as O}from"./ExclamationTriangleIcon-Y0luX6t1.js";import{F as U}from"./CheckCircleIcon-B-MrGrlS.js";import{F as H}from"./DocumentArrowUpIcon-DBsAc1ml.js";import{F as J}from"./ClockIcon-CbdR_WDb.js";import"./vendor-Csw2ODfV.js";import"./icons-C8WIGuh4.js";const ue=()=>{const[c,F]=n.useState([]),[A,h]=n.useState(!0),[i,f]=n.useState({status:"",setor_origem:"",setor_destino:"",data_inicio:"",data_fim:"",busca:""}),[a,o]=n.useState({pagina:1,por_pagina:20,total:0}),[x,u]=n.useState([]),[b,E]=n.useState([]);n.useEffect(()=>{j(),R()},[a.pagina,i]);const j=async()=>{try{h(!0);const s=await v.listarTramitacoes({...i,pagina:a.pagina,por_pagina:a.por_pagina});F(s.results||s),o(r=>({...r,total:s.count||s.length}))}catch(s){console.error("Erro ao carregar tramitações:",s),_.error("Erro ao carregar tramitações")}finally{h(!1)}},R=async()=>{try{const s=await v.listarSetores();E(s)}catch(s){console.error("Erro ao carregar setores:",s)}},l=(s,r)=>{f(t=>({...t,[s]:r})),o(t=>({...t,pagina:1}))},D=()=>{f({status:"",setor_origem:"",setor_destino:"",data_inicio:"",data_fim:"",busca:""}),o(s=>({...s,pagina:1}))},S=s=>{u(r=>r.includes(s)?r.filter(t=>t!==s):[...r,s])},k=()=>{x.length===c.length?u([]):u(c.map(s=>s.id))},C=s=>{switch(s){case"PENDENTE":return"text-yellow-600 bg-yellow-50";case"ENVIADA":return"text-blue-600 bg-blue-50";case"RECEBIDA":return"text-green-600 bg-green-50";case"ATRASADA":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}},T=s=>{switch(s){case"PENDENTE":return e.jsx(J,{className:"w-4 h-4"});case"ENVIADA":return e.jsx(H,{className:"w-4 h-4"});case"RECEBIDA":return e.jsx(U,{className:"w-4 h-4"});case"ATRASADA":return e.jsx(O,{className:"w-4 h-4"});default:return e.jsx(G,{className:"w-4 h-4"})}},y=s=>new Date(s).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),N=s=>{if(!s)return 0;const r=new Date,t=new Date(s),d=r-t,m=Math.ceil(d/(1e3*60*60*24));return m>0?m:0},p=Math.ceil(a.total/a.por_pagina);return A?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tramitações"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Gerencie todas as tramitações do sistema"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),"Atualizar"]}),e.jsxs(g,{to:"/tramitacao/nova",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(z,{className:"w-4 h-4"}),"Nova Tramitação"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar por protocolo, assunto, setor...",value:i.busca,onChange:s=>l("busca",s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),e.jsx("div",{children:e.jsxs("select",{value:i.status,onChange:s=>l("status",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todos os status"}),e.jsx("option",{value:"PENDENTE",children:"Pendente"}),e.jsx("option",{value:"ENVIADA",children:"Enviada"}),e.jsx("option",{value:"RECEBIDA",children:"Recebida"}),e.jsx("option",{value:"ATRASADA",children:"Atrasada"})]})}),e.jsx("div",{children:e.jsxs("select",{value:i.setor_origem,onChange:s=>l("setor_origem",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todos os setores origem"}),b.map(s=>e.jsx("option",{value:s.id,children:s.nome},s.id))]})}),e.jsx("div",{children:e.jsxs("select",{value:i.setor_destino,onChange:s=>l("setor_destino",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todos os setores destino"}),b.map(s=>e.jsx("option",{value:s.id,children:s.nome},s.id))]})}),e.jsx("div",{children:e.jsx("input",{type:"date",value:i.data_inicio,onChange:s=>l("data_inicio",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),e.jsx("div",{children:e.jsx("input",{type:"date",value:i.data_fim,onChange:s=>l("data_fim",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[e.jsx(I,{className:"w-4 h-4"}),"Limpar"]})})]})}),x.length>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-blue-800 font-medium",children:[x.length," tramitação(ões) selecionada(s)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Marcar como Recebida"}),e.jsx("button",{className:"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:"Excluir"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:x.length===c.length&&c.length>0,onChange:k,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Protocolo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assunto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Origem → Destino"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data Tramitação"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prazo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuário"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(s=>{var r,t,d,m,w;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",checked:x.includes(s.id),onChange:()=>S(s.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((r=s.protocolo)==null?void 0:r.numero_protocolo)||"N/A"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:((t=s.protocolo)==null?void 0:t.assunto)||"Assunto não informado"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${C(s.status)}`,children:[T(s.status),s.status]}),s.prazo_limite&&N(s.prazo_limite)>0&&e.jsxs("div",{className:"mt-1 text-xs text-red-600",children:[N(s.prazo_limite)," dias atrasado"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[(d=s.setor_origem)==null?void 0:d.nome," → ",(m=s.setor_destino)==null?void 0:m.nome]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y(s.data_tramitacao)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.prazo_limite?y(s.prazo_limite):"Sem prazo"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((w=s.usuario)==null?void 0:w.nome)||"Sistema"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(g,{to:`/tramitacao/${s.id}`,className:"text-blue-600 hover:text-blue-900",children:e.jsx(M,{className:"w-4 h-4"})}),e.jsx(g,{to:`/tramitacao/${s.id}/editar`,className:"text-green-600 hover:text-green-900",children:e.jsx(B,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{window.confirm("Tem certeza que deseja excluir esta tramitação?")&&_.success("Tramitação excluída com sucesso")},className:"text-red-600 hover:text-red-900",children:e.jsx(L,{className:"w-4 h-4"})})]})})]},s.id)})})]})}),p>1&&e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>o(s=>({...s,pagina:s.pagina-1})),disabled:a.pagina===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),e.jsx("button",{onClick:()=>o(s=>({...s,pagina:s.pagina+1})),disabled:a.pagina===p,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Próxima"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:(a.pagina-1)*a.por_pagina+1})," a"," ",e.jsx("span",{className:"font-medium",children:Math.min(a.pagina*a.por_pagina,a.total)})," ","de ",e.jsx("span",{className:"font-medium",children:a.total})," resultados"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>o(s=>({...s,pagina:s.pagina-1})),disabled:a.pagina===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:e.jsx(V,{className:"h-5 w-5"})}),Array.from({length:Math.min(5,p)},(s,r)=>{const t=r+1;return e.jsx("button",{onClick:()=>o(d=>({...d,pagina:t})),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${t===a.pagina?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:t},t)}),e.jsx("button",{onClick:()=>o(s=>({...s,pagina:s.pagina+1})),disabled:a.pagina===p,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:e.jsx(q,{className:"h-5 w-5"})})]})})]})]})]})]})})};export{ue as default};
