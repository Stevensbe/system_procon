import{j as e,L as F}from"./main-QkSqPps8.js";import{e as C,u as S,r as c}from"./router-C15yhWin.js";import{c as l}from"./cobrancaService-y4NTKzV9.js";import{n as i}from"./index-CsOmCsbp.js";import{F as E}from"./ArrowLeftIcon-B1Aara0h.js";import{F as A}from"./UserIcon-Crv8uqGG.js";import{F as B}from"./CalendarIcon-BxLx5Sh6.js";import{F as D}from"./XMarkIcon-C8R2LFm1.js";import{F as $}from"./CheckIcon-TbLvWjzX.js";import{F as k}from"./DocumentArrowDownIcon-Bp61FGwk.js";import"./vendor-Csw2ODfV.js";import"./icons-C8WIGuh4.js";const Q=()=>{const{id:a}=C(),d=S(),[j,n]=c.useState(!1),[b,u]=c.useState(!1),[h,v]=c.useState([]),[o,g]=c.useState({banco:"",tipo:"remessa",observacoes:""}),[t,p]=c.useState({});c.useEffect(()=>{N(),a&&y()},[a]);const N=async()=>{try{n(!0);const[s]=await Promise.all([l.getBancos()]);v(Array.isArray(s)?s:[])}catch(s){console.error("Erro ao carregar dados iniciais:",s),i.error("Erro ao carregar dados iniciais")}finally{n(!1)}},y=async()=>{var s;try{n(!0);const r=await l.getRemessa(a);g({banco:((s=r.banco)==null?void 0:s.id)||"",tipo:r.tipo||"remessa",observacoes:r.observacoes||""})}catch(r){console.error("Erro ao carregar remessa:",r),i.error("Erro ao carregar remessa"),d("/cobranca/remessas")}finally{n(!1)}},m=(s,r)=>{g(x=>({...x,[s]:r})),t[s]&&p(x=>({...x,[s]:""}))},w=()=>{const s={};return o.banco||(s.banco="Banco é obrigatório"),o.tipo||(s.tipo="Tipo é obrigatório"),p(s),Object.keys(s).length===0},R=async s=>{if(s.preventDefault(),!w()){i.error("Por favor, corrija os erros no formulário");return}try{u(!0),a?(await l.updateRemessa(a,o),i.success("Remessa atualizada com sucesso!")):(await l.createRemessa(o),i.success("Remessa criada com sucesso!")),d("/cobranca/remessas")}catch(r){console.error("Erro ao salvar remessa:",r),i.error("Erro ao salvar remessa")}finally{u(!1)}},f=()=>{d("/cobranca/remessas")};return j?e.jsx(F,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:f,className:"text-gray-600 hover:text-gray-900",children:e.jsx(E,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a?"Editar Remessa":"Nova Remessa"}),e.jsx("p",{className:"text-gray-600",children:a?"Edite os dados da remessa bancária":"Crie uma nova remessa bancária"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow",children:e.jsxs("form",{onSubmit:R,className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Dados Básicos"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Banco ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:o.banco,onChange:s=>m("banco",s.target.value),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.banco?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Selecione um banco"}),Array.isArray(h)&&h.map(s=>e.jsxs("option",{value:s.id,children:[s.codigo," - ",s.nome]},s.id))]}),t.banco&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.banco})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tipo ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:o.tipo,onChange:s=>m("tipo",s.target.value),className:`w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.tipo?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"remessa",children:"Remessa"}),e.jsx("option",{value:"retorno",children:"Retorno"})]}),t.tipo&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.tipo})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Observações"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações"}),e.jsx("textarea",{value:o.observacoes,onChange:s=>m("observacoes",s.target.value),rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Digite observações sobre a remessa..."})]})]}),a&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informações do Sistema"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"font-medium text-gray-500",children:"Criado por:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:"Sistema"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"font-medium text-gray-500",children:"Criado em:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:"Data atual"})]})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:f,className:"btn-secondary",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Cancelar"]}),e.jsx("button",{type:"submit",disabled:b,className:"btn-primary",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4 mr-2"}),a?"Atualizar":"Criar"," Remessa"]})})]})]})}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:[e.jsx(k,{className:"w-5 h-5 inline mr-2"}),"Sobre Remessas Bancárias"]}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Remessa:"})," Arquivo CNAB enviado ao banco com os dados dos boletos para registro."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Retorno:"})," Arquivo CNAB recebido do banco com as confirmações de processamento."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Processo:"})," Após criar a remessa, você pode gerar o arquivo CNAB e enviá-lo ao banco."]})]})]})]})};export{Q as default};
