import{h as y,j as e,m as w}from"./main-BZolao6g.js";import{a as z,u as C,r as i,L as u}from"./router-Cgdj9vyr.js";import"./vendor-Csw2ODfV.js";import"./icons-qiKTog5F.js";function S(){const{id:d}=z(),g=C(),[_,b]=i.useState(!0),[t,p]=i.useState(!1),[n,m]=i.useState(""),[s,x]=i.useState({numero:"",data_fiscalizacao:"",hora_fiscalizacao:"",razao_social:"",nome_fantasia:"",cnpj:"",endereco:"",municipio:"",cep:"",telefone:"",email:"",responsavel_nome:"",responsavel_cpf:"",responsavel_funcao:"",produtos_vencidos:!1,produtos_vencidos_obs:"",embalagem_violada:!1,embalagem_violada_obs:"",lata_amassada:!1,lata_amassada_obs:"",sem_validade:!1,sem_validade_obs:"",validade_ilegivel:!1,validade_ilegivel_obs:"",mal_armazenados:!1,mal_armazenados_obs:"",produtos_descongelados:!1,produtos_descongelados_obs:"",publicidade_enganosa:!1,publicidade_enganosa_obs:"",obstrucao_monitor:!1,obstrucao_monitor_obs:"",precos_fora_padrao:!1,precos_fora_padrao_obs:"",ausencia_precos:!1,ausencia_precos_obs:"",fracionados_fora_padrao:!1,fracionados_fora_padrao_obs:"",ausencia_desconto_visibilidade:!1,ausencia_desconto_visibilidade_obs:"",ausencia_placas_promocao:!1,ausencia_placas_promocao_obs:"",observacoes:"",fiscal_responsavel:"",fiscal_apoio:""});i.useEffect(()=>{h()},[d]);const h=async()=>{try{b(!0);const a=await y(d),r={...a,data_fiscalizacao:a.data_fiscalizacao||"",hora_fiscalizacao:a.hora_fiscalizacao||"",produtos_vencidos:!!a.produtos_vencidos,embalagem_violada:!!a.embalagem_violada,lata_amassada:!!a.lata_amassada,sem_validade:!!a.sem_validade,validade_ilegivel:!!a.validade_ilegivel,mal_armazenados:!!a.mal_armazenados,produtos_descongelados:!!a.produtos_descongelados,publicidade_enganosa:!!a.publicidade_enganosa,obstrucao_monitor:!!a.obstrucao_monitor,precos_fora_padrao:!!a.precos_fora_padrao,ausencia_precos:!!a.ausencia_precos,fracionados_fora_padrao:!!a.fracionados_fora_padrao,ausencia_desconto_visibilidade:!!a.ausencia_desconto_visibilidade,ausencia_placas_promocao:!!a.ausencia_placas_promocao};x(r)}catch(a){m(a.message||"Erro ao carregar auto de supermercado")}finally{b(!1)}},o=a=>{const{name:r,value:c,type:v,checked:j}=a.target;x(N=>({...N,[r]:v==="checkbox"?j:c}))},f=async a=>{a.preventDefault();try{p(!0),m(""),await w(d,s),g(`/fiscalizacao/supermercados/${d}`,{state:{message:"Auto de supermercado atualizado com sucesso!"}})}catch(r){m(r.message||"Erro ao atualizar auto de supermercado")}finally{p(!1)}},l=({name:a,label:r,obsName:c})=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",name:a,checked:s[a],onChange:o,className:"mr-2",id:a}),e.jsx("label",{htmlFor:a,className:"text-sm font-medium text-gray-700",children:r})]}),s[a]&&e.jsx("textarea",{name:c,value:s[c]||"",onChange:o,placeholder:"Descreva os detalhes...",className:"w-full p-2 border border-gray-300 rounded-md text-sm",rows:2})]});return _?e.jsx("div",{className:"flex justify-center items-center p-8 min-h-64",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"}),e.jsx("div",{className:"text-lg text-gray-600",children:"Carregando auto de supermercado..."})]})}):n&&!s.id?e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-6 py-4 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Erro ao carregar auto"}),e.jsx("p",{className:"mt-2",children:n}),e.jsx(u,{to:"/fiscalizacao/supermercado",className:"mt-3 inline-block px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"← Voltar à lista"})]})}):e.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-green-800",children:"Editar Auto de Supermercado"}),e.jsxs("p",{className:"text-gray-600",children:["Auto nº ",s.numero||d]})]}),e.jsx(u,{to:`/fiscalizacao/supermercados/${d}`,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"← Voltar"})]})}),n&&e.jsx("div",{className:"mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:n}),e.jsxs("form",{onSubmit:f,className:"space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold text-green-800 mb-4",children:"Dados Básicos"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número do Auto"}),e.jsx("input",{type:"text",name:"numero",value:s.numero,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Ex: 2024/001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Fiscalização *"}),e.jsx("input",{type:"date",name:"data_fiscalizacao",value:s.data_fiscalizacao,onChange:o,required:!0,className:"w-full p-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hora da Fiscalização"}),e.jsx("input",{type:"time",name:"hora_fiscalizacao",value:s.hora_fiscalizacao,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold text-green-800 mb-4",children:"Dados do Estabelecimento"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Razão Social *"}),e.jsx("input",{type:"text",name:"razao_social",value:s.razao_social,onChange:o,required:!0,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Digite a razão social"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Fantasia"}),e.jsx("input",{type:"text",name:"nome_fantasia",value:s.nome_fantasia,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Digite o nome fantasia"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CNPJ *"}),e.jsx("input",{type:"text",name:"cnpj",value:s.cnpj,onChange:o,required:!0,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"00.000.000/0000-00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Município *"}),e.jsx("input",{type:"text",name:"municipio",value:s.municipio,onChange:o,required:!0,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Digite o município"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Endereço"}),e.jsx("input",{type:"text",name:"endereco",value:s.endereco,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Digite o endereço completo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CEP"}),e.jsx("input",{type:"text",name:"cep",value:s.cep,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"00000-000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),e.jsx("input",{type:"text",name:"telefone",value:s.telefone,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"(00) 0000-0000"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"E-mail"}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"email@exemplo.com"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold text-green-800 mb-4",children:"Responsável Legal"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Responsável"}),e.jsx("input",{type:"text",name:"responsavel_nome",value:s.responsavel_nome,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Nome completo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CPF do Responsável"}),e.jsx("input",{type:"text",name:"responsavel_cpf",value:s.responsavel_cpf,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"000.000.000-00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Função"}),e.jsx("input",{type:"text",name:"responsavel_funcao",value:s.responsavel_funcao,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Ex: Gerente, Proprietário"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold text-green-800 mb-4",children:"Irregularidades - Produtos"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(l,{name:"produtos_vencidos",label:"Produtos com validade vencida",obsName:"produtos_vencidos_obs"}),e.jsx(l,{name:"embalagem_violada",label:"Produtos com embalagem violada",obsName:"embalagem_violada_obs"}),e.jsx(l,{name:"lata_amassada",label:"Latas amassadas",obsName:"lata_amassada_obs"}),e.jsx(l,{name:"sem_validade",label:"Produtos sem data de validade",obsName:"sem_validade_obs"}),e.jsx(l,{name:"validade_ilegivel",label:"Validade ilegível",obsName:"validade_ilegivel_obs"}),e.jsx(l,{name:"mal_armazenados",label:"Produtos mal armazenados",obsName:"mal_armazenados_obs"}),e.jsx(l,{name:"produtos_descongelados",label:"Produtos descongelados inadequadamente",obsName:"produtos_descongelados_obs"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold text-green-800 mb-4",children:"Irregularidades - Publicidade e Preços"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(l,{name:"publicidade_enganosa",label:"Publicidade enganosa",obsName:"publicidade_enganosa_obs"}),e.jsx(l,{name:"obstrucao_monitor",label:"Obstrução de monitor de preços",obsName:"obstrucao_monitor_obs"}),e.jsx(l,{name:"precos_fora_padrao",label:"Preços fora do padrão",obsName:"precos_fora_padrao_obs"}),e.jsx(l,{name:"ausencia_precos",label:"Ausência de preços",obsName:"ausencia_precos_obs"}),e.jsx(l,{name:"fracionados_fora_padrao",label:"Produtos fracionados fora do padrão",obsName:"fracionados_fora_padrao_obs"}),e.jsx(l,{name:"ausencia_desconto_visibilidade",label:"Falta de visibilidade em descontos",obsName:"ausencia_desconto_visibilidade_obs"}),e.jsx(l,{name:"ausencia_placas_promocao",label:"Ausência de placas de promoção",obsName:"ausencia_placas_promocao_obs"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold text-green-800 mb-4",children:"Fiscais Responsáveis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fiscal Responsável"}),e.jsx("input",{type:"text",name:"fiscal_responsavel",value:s.fiscal_responsavel,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Nome do fiscal responsável"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fiscal de Apoio"}),e.jsx("input",{type:"text",name:"fiscal_apoio",value:s.fiscal_apoio,onChange:o,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Nome do fiscal de apoio"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-xl font-semibold text-green-800 mb-4",children:"Observações"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações Gerais"}),e.jsx("textarea",{name:"observacoes",value:s.observacoes,onChange:o,rows:4,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Observações adicionais..."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(u,{to:`/fiscalizacao/supermercados/${d}`,className:"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:t,className:`px-6 py-3 rounded-lg text-white font-medium ${t?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:t?"Salvando...":"Salvar Alterações"})]})]})]})}export{S as default};
