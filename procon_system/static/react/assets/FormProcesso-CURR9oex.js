import{j as e}from"./main-BlGnCLHT.js";import{e as $,u as R,r as m}from"./router-C15yhWin.js";import{j as p}from"./juridicoService-B0le0wh-.js";import{L as I}from"./LoadingSpinner-B1xxHhLi.js";import{N as O}from"./NotificationContainer-uqWzZZ4D.js";import{u as L}from"./useNotification-Bm6NCblX.js";import{F as B}from"./ArrowLeftIcon-B1Aara0h.js";import{F as M}from"./DocumentTextIcon-o9njoXYt.js";import{F as T}from"./CurrencyDollarIcon-rQfx65sT.js";import{F as J}from"./CalendarIcon-BxLx5Sh6.js";import{F as U}from"./UserIcon-Crv8uqGG.js";import{F as V}from"./XMarkIcon-C8R2LFm1.js";import"./vendor-Csw2ODfV.js";import"./icons-C8WIGuh4.js";import"./InformationCircleIcon-o8enZ7c_.js";import"./ExclamationTriangleIcon-Y0luX6t1.js";import"./XCircleIcon-BTR4Rsg8.js";import"./CheckCircleIcon-B-MrGrlS.js";const q=({className:l})=>e.jsx("svg",{className:l,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 0V4a2 2 0 00-2-2H9a2 2 0 00-2 2v3m1 0h4"})}),le=()=>{const{id:l}=$(),g=R(),[h,x]=m.useState(!1),[j,k]=m.useState([]),[N,y]=m.useState(!0),{notifications:w,addNotification:c,removeNotification:_}=L(),[s,b]=m.useState({numero_peticao:"",parte:"",empresa_cnpj:"",assunto:"",descricao:"",valor_causa:"",status:"ABERTO",prioridade:"MEDIA",data_limite:"",analista:""}),[o,v]=m.useState({}),u=!!l;m.useEffect(()=>{A(),u&&C()},[l]);const A=async()=>{try{y(!0);const r=await p.listarAnalistas();k(r.data.results||r.data)}catch(r){console.error("Erro ao carregar analistas:",r),c("Erro ao carregar lista de analistas","error")}finally{y(!1)}},C=async()=>{var r;try{x(!0);const a=(await p.getProcesso(l)).data;b({numero_peticao:a.numero_peticao||"",parte:a.parte||"",empresa_cnpj:a.empresa_cnpj||"",assunto:a.assunto||"",descricao:a.descricao||"",valor_causa:a.valor_causa||"",status:a.status||"ABERTO",prioridade:a.prioridade||"MEDIA",data_limite:a.data_limite?new Date(a.data_limite).toISOString().split("T")[0]:"",analista:((r=a.analista)==null?void 0:r.id)||""})}catch(t){console.error("Erro ao carregar processo:",t),c("Erro ao carregar dados do processo","error")}finally{x(!1)}},i=r=>{const{name:t,value:a}=r.target;b(d=>({...d,[t]:a})),o[t]&&v(d=>({...d,[t]:""}))},E=()=>{const r={};return s.parte.trim()||(r.parte="Parte envolvida é obrigatória"),s.assunto.trim()||(r.assunto="Assunto é obrigatório"),s.descricao.trim()||(r.descricao="Descrição é obrigatória"),s.valor_causa&&isNaN(parseFloat(s.valor_causa))&&(r.valor_causa="Valor da causa deve ser um número válido"),s.empresa_cnpj&&!P(s.empresa_cnpj)&&(r.empresa_cnpj="CNPJ inválido"),v(r),Object.keys(r).length===0},P=r=>{if(r=r.replace(/[^\d]/g,""),r.length!==14||/^(\d)\1+$/.test(r))return!1;let t=0,a=2;for(let n=11;n>=0;n--)t+=parseInt(r.charAt(n))*a,a=a===9?2:a+1;let d=11-t%11;if(d>9&&(d=0),parseInt(r.charAt(12))!==d)return!1;t=0,a=2;for(let n=12;n>=0;n--)t+=parseInt(r.charAt(n))*a,a=a===9?2:a+1;let f=11-t%11;return f>9&&(f=0),parseInt(r.charAt(13))===f},D=r=>r.replace(/\D/g,"").replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/,"$1.$2.$3/$4-$5"),S=r=>{const{value:t}=r.target,a=D(t);b(d=>({...d,empresa_cnpj:a}))},F=async r=>{if(r.preventDefault(),!E()){c("Por favor, corrija os erros no formulário","error");return}try{x(!0);const t={...s,valor_causa:s.valor_causa?parseFloat(s.valor_causa):null,data_limite:s.data_limite?new Date(s.data_limite).toISOString():null,analista:s.analista||null};u?(await p.atualizarProcesso(l,t),c("Processo atualizado com sucesso!","success")):(await p.criarProcesso(t),c("Processo criado com sucesso!","success")),g("/juridico/processos")}catch(t){console.error("Erro ao salvar processo:",t),c("Erro ao salvar processo","error")}finally{x(!1)}};return h?e.jsx(I,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(O,{notifications:w,onRemove:_}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>g("/juridico/processos"),className:"mr-4 p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:e.jsx(B,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:u?"Editar Processo":"Novo Processo"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:u?"Atualize as informações do processo":"Preencha as informações do novo processo"})]})]})})}),e.jsxs("form",{onSubmit:F,className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(M,{className:"h-5 w-5 mr-2"}),"Informações Básicas"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Número da Petição"}),e.jsx("input",{type:"text",name:"numero_peticao",value:s.numero_peticao,onChange:i,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${o.numero_peticao?"border-red-500":"border-gray-300"}`,placeholder:"Número da petição (opcional)"}),o.numero_peticao&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.numero_peticao})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Parte Envolvida *"}),e.jsx("input",{type:"text",name:"parte",value:s.parte,onChange:i,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${o.parte?"border-red-500":"border-gray-300"}`,placeholder:"Nome da parte envolvida",required:!0}),o.parte&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.parte})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"CNPJ da Empresa"}),e.jsx("input",{type:"text",name:"empresa_cnpj",value:s.empresa_cnpj,onChange:S,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${o.empresa_cnpj?"border-red-500":"border-gray-300"}`,placeholder:"00.000.000/0000-00",maxLength:18}),o.empresa_cnpj&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.empresa_cnpj})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Assunto *"}),e.jsx("input",{type:"text",name:"assunto",value:s.assunto,onChange:i,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${o.assunto?"border-red-500":"border-gray-300"}`,placeholder:"Assunto do processo",required:!0}),o.assunto&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.assunto})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Valor da Causa"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(T,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"number",name:"valor_causa",value:s.valor_causa,onChange:i,step:"0.01",min:"0",className:`w-full pl-10 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${o.valor_causa?"border-red-500":"border-gray-300"}`,placeholder:"0,00"})]}),o.valor_causa&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.valor_causa})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Data Limite"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"date",name:"data_limite",value:s.data_limite,onChange:i,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(U,{className:"h-5 w-5 mr-2"}),"Status e Atribuição"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{name:"status",value:s.status,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[e.jsx("option",{value:"ABERTO",children:"Aberto"}),e.jsx("option",{value:"EM_ANALISE",children:"Em Análise"}),e.jsx("option",{value:"AGUARDANDO_DOCUMENTO",children:"Aguardando Documento"}),e.jsx("option",{value:"RESPONDIDO",children:"Respondido"}),e.jsx("option",{value:"ARQUIVADO",children:"Arquivado"}),e.jsx("option",{value:"CANCELADO",children:"Cancelado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Prioridade"}),e.jsxs("select",{name:"prioridade",value:s.prioridade,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[e.jsx("option",{value:"BAIXA",children:"Baixa"}),e.jsx("option",{value:"MEDIA",children:"Média"}),e.jsx("option",{value:"ALTA",children:"Alta"}),e.jsx("option",{value:"URGENTE",children:"Urgente"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Analista Responsável"}),e.jsxs("select",{name:"analista",value:s.analista,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",disabled:N,children:[e.jsx("option",{value:"",children:"Selecione um analista"}),j.map(r=>e.jsxs("option",{value:r.id,children:[r.user.first_name," ",r.user.last_name," - ",r.oab]},r.id))]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Descrição *"}),e.jsx("textarea",{name:"descricao",value:s.descricao,onChange:i,rows:6,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${o.descricao?"border-red-500":"border-gray-300"}`,placeholder:"Descreva detalhadamente o processo...",required:!0}),o.descricao&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:o.descricao})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600 flex justify-end space-x-3",children:[e.jsxs("button",{type:"button",onClick:()=>g("/juridico/processos"),className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-50 dark:hover:bg-gray-500 flex items-center",children:[e.jsx(V,{className:"h-5 w-5 mr-2"}),"Cancelar"]}),e.jsxs("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[e.jsx(q,{className:"h-5 w-5 mr-2"}),h?"Salvando...":u?"Atualizar":"Criar"]})]})]})]})]})};export{le as default};
