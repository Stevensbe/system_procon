import{j as e,I as q,G as n}from"./main-CRMJS0Wv.js";import{r as x,a as B,u as R,L as P}from"./router-Cgdj9vyr.js";import{m as M,M as $}from"./MultaForm-GeErSjwf.js";import{a as C,f as L}from"./formatters-Dm0PafFw.js";import{F as E}from"./PlusIcon-CPn5D4W5.js";import{F}from"./ExclamationTriangleIcon-2kHM3Vz3.js";import{F as S}from"./DocumentArrowUpIcon-DteXzQOc.js";import{F as H}from"./EyeIcon-xG4b5U4j.js";import{F as A}from"./XMarkIcon-D1YaT3yw.js";import"./vendor-Csw2ODfV.js";import"./icons-qiKTog5F.js";function W({historico:c=[]}){const a=r=>{const d={criacao:"🆕",status_change:"🔄",documento_upload:"📄",prazo_vencido:"⚠️",notificacao:"📬",defesa:"⚖️",recurso:"📋",julgamento:"🏛️",finalizacao:"✅",default:"📝"};return d[r]||d.default},f=r=>{const d={criacao:"bg-blue-100 text-blue-800 border-blue-200",status_change:"bg-purple-100 text-purple-800 border-purple-200",documento_upload:"bg-green-100 text-green-800 border-green-200",prazo_vencido:"bg-red-100 text-red-800 border-red-200",notificacao:"bg-yellow-100 text-yellow-800 border-yellow-200",defesa:"bg-indigo-100 text-indigo-800 border-indigo-200",recurso:"bg-orange-100 text-orange-800 border-orange-200",julgamento:"bg-purple-100 text-purple-800 border-purple-200",finalizacao:"bg-green-100 text-green-800 border-green-200",default:"bg-gray-100 text-gray-800 border-gray-200"};return d[r]||d.default},g=r=>{try{const d=new Date(r);return{data:d.toLocaleDateString("pt-BR"),hora:d.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}}catch{return{data:"Data inválida",hora:""}}};return!c||c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Nenhum histórico disponível"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"O histórico de tramitação aparecerá aqui conforme o processo for movimentado."})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Histórico de Tramitação"}),e.jsx("div",{className:"flow-root",children:e.jsx("ul",{className:"-mb-8",children:c.map((r,d)=>{const p=d===c.length-1,{data:u,hora:l}=g(r.data_ocorrencia);return e.jsx("li",{children:e.jsxs("div",{className:"relative pb-8",children:[!p&&e.jsx("span",{className:"absolute top-5 left-5 -ml-px h-full w-0.5 bg-gray-200","aria-hidden":"true"}),e.jsxs("div",{className:"relative flex items-start space-x-3",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:`h-10 w-10 rounded-full border-2 flex items-center justify-center text-lg ${f(r.tipo)}`,children:a(r.tipo)})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:r.titulo||r.descricao_mudanca}),r.descricao&&r.descricao!==r.titulo&&e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:r.descricao}),r.detalhes&&e.jsx("div",{className:"mt-2 text-xs text-gray-500 bg-gray-50 p-2 rounded",children:r.detalhes}),e.jsxs("div",{className:"mt-2 flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),u]}),l&&e.jsxs("span",{className:"flex items-center",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),l]}),r.usuario_responsavel&&e.jsxs("span",{className:"flex items-center",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),r.usuario_responsavel]})]})]}),r.status_anterior&&r.status_novo&&e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded",children:r.status_anterior}),e.jsx("span",{className:"mx-1",children:"→"}),e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded",children:r.status_novo})]})})]}),r.anexos&&r.anexos.length>0&&e.jsxs("div",{className:"mt-3 border-t border-gray-100 pt-3",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Anexos:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.anexos.map((h,b)=>e.jsxs("a",{href:h.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-2 py-1 text-xs bg-blue-50 text-blue-700 rounded hover:bg-blue-100",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),h.nome]},b))})]})]})})]})]})},r.id||d)})})}),e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:[e.jsx("strong",{children:c.length})," eventos no histórico"]}),c.length>0&&e.jsxs("span",{children:["Último movimento: ",g(c[0].data_ocorrencia).data]})]})})]})}function T({processoId:c,onUploadSuccess:a,onUploadError:f}){const[g,r]=x.useState(!1),[d,p]=x.useState(!1),u=x.useRef(null),[l,h]=x.useState({tipo_documento:"",descricao:"",arquivo:null}),b=[{value:"defesa_previa",label:"Defesa Prévia"},{value:"recurso",label:"Recurso"},{value:"parecer_juridico",label:"Parecer Jurídico"},{value:"notificacao",label:"Notificação"},{value:"comprovante_pagamento",label:"Comprovante de Pagamento"},{value:"documento_adicional",label:"Documento Adicional"},{value:"correspondencia",label:"Correspondência"},{value:"laudo_tecnico",label:"Laudo Técnico"},{value:"outros",label:"Outros"}],v=s=>{const{name:i,value:o}=s.target;h(j=>({...j,[i]:o}))},w=s=>{if(s){if(!["application/pdf","image/jpeg","image/png","image/gif","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(s.type)){alert("Tipo de arquivo não permitido. Use PDF, imagens, Word ou Excel.");return}if(s.size>10*1024*1024){alert("Arquivo muito grande. Máximo permitido: 10MB");return}h(o=>({...o,arquivo:s}))}},N=s=>{s.preventDefault(),s.stopPropagation(),s.type==="dragenter"||s.type==="dragover"?p(!0):s.type==="dragleave"&&p(!1)},k=s=>{s.preventDefault(),s.stopPropagation(),p(!1),s.dataTransfer.files&&s.dataTransfer.files[0]&&w(s.dataTransfer.files[0])},m=s=>{s.target.files&&s.target.files[0]&&w(s.target.files[0])},y=async s=>{if(s.preventDefault(),!l.arquivo){alert("Por favor, selecione um arquivo");return}if(!l.tipo_documento){alert("Por favor, selecione o tipo de documento");return}r(!0);try{const i=new FormData;i.append("arquivo",l.arquivo),i.append("tipo_documento",l.tipo_documento),i.append("descricao",l.descricao),await q(c,i),h({tipo_documento:"",descricao:"",arquivo:null}),u.current&&(u.current.value=""),a&&a()}catch(i){console.error("Erro ao fazer upload:",i),f?f(i.message||"Erro ao enviar documento"):alert("Erro ao enviar documento: "+(i.message||"Erro desconhecido"))}finally{r(!1)}},_=s=>{var j;const i=(j=s==null?void 0:s.split(".").pop())==null?void 0:j.toLowerCase();return{pdf:"📄",doc:"📝",docx:"📝",xls:"📊",xlsx:"📊",jpg:"🖼️",jpeg:"🖼️",png:"🖼️",gif:"🖼️"}[i]||"📎"},z=s=>{if(s===0)return"0 Bytes";const i=1024,o=["Bytes","KB","MB","GB"],j=Math.floor(Math.log(s)/Math.log(i));return parseFloat((s/Math.pow(i,j)).toFixed(2))+" "+o[j]};return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Adicionar Documento"}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Documento *"}),e.jsxs("select",{name:"tipo_documento",value:l.tipo_documento,onChange:v,required:!0,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Selecione o tipo..."}),b.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição"}),e.jsx("textarea",{name:"descricao",value:l.descricao,onChange:v,placeholder:"Descrição opcional do documento...",rows:3,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Arquivo *"}),e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors
                            ${d?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:k,onClick:()=>{var s;return(s=u.current)==null?void 0:s.click()},children:[e.jsx("input",{ref:u,type:"file",onChange:m,accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif",className:"hidden"}),l.arquivo?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-4xl",children:_(l.arquivo.name)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:l.arquivo.name}),e.jsx("p",{className:"text-xs text-gray-500",children:z(l.arquivo.size)})]}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),h(i=>({...i,arquivo:null})),u.current&&(u.current.value="")},className:"text-sm text-red-600 hover:text-red-800",children:"Remover arquivo"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:e.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Clique para selecionar ou arraste o arquivo aqui"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF, Word, Excel, Imagens - Máximo 10MB"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>{h({tipo_documento:"",descricao:"",arquivo:null}),u.current&&(u.current.value="")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Limpar"}),e.jsx("button",{type:"submit",disabled:g||!l.arquivo||!l.tipo_documento,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center",children:g?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Enviar Documento"]})})]})]})]})}function I({processoId:c}){const[a,f]=x.useState(null),[g,r]=x.useState(!0),[d,p]=x.useState(!1),[u,l]=x.useState(!1);x.useEffect(()=>{h()},[c]);const h=async()=>{try{r(!0);const m=await M.getMultas({processo:c});m.results&&m.results.length>0?f(m.results[0]):f(null)}catch(m){console.error("Erro ao carregar multa:",m),f(null)}finally{r(!1)}},b=()=>{p(!1),h()},v=async()=>{if(a)try{await M.marcarComoPaga(a.id),h()}catch(m){console.error("Erro ao marcar como paga:",m)}},w=async()=>{if(a&&window.confirm("Tem certeza que deseja cancelar esta multa?"))try{await M.cancelarMulta(a.id),h()}catch(m){console.error("Erro ao cancelar multa:",m)}},N=m=>{const y={true:{color:"bg-green-100 text-green-800",text:"Paga"},false:{color:"bg-yellow-100 text-yellow-800",text:"Pendente"}},_=y[m]||y.false;return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_.color}`,children:_.text})},k=()=>{if(!a||a.pago)return!1;const m=new Date;return new Date(a.data_vencimento)<m};return g?e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"})]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Multa Aplicada"}),!a&&e.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center px-3 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Gerar Multa"]})]}),a?e.jsxs("div",{className:"space-y-4",children:[k()&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"w-5 h-5 text-red-400 mr-2"}),e.jsxs("p",{className:"text-red-800 text-sm font-medium",children:["Esta multa está vencida desde ",C(a.data_vencimento)]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Valor"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:L(a.valor)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Status"}),e.jsx("div",{className:"mt-1",children:N(a.pago)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Data de Emissão"}),e.jsx("p",{className:"text-gray-900",children:C(a.data_emissao)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Data de Vencimento"}),e.jsx("p",{className:"text-gray-900",children:C(a.data_vencimento)})]})]}),a.observacoes&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Observações"}),e.jsx("p",{className:"text-gray-900",children:a.observacoes})]}),a.comprovante_pagamento&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Comprovante de Pagamento"}),e.jsxs("a",{href:a.comprovante_pagamento,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-sm text-blue-600 hover:text-blue-800",children:[e.jsx(S,{className:"w-4 h-4 mr-1"}),"Ver comprovante"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 border-t",children:[e.jsxs("button",{onClick:()=>l(!0),className:"inline-flex items-center px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Ver Detalhes"]}),!a.pago&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:v,className:"inline-flex items-center px-3 py-2 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Marcar como Paga"]}),e.jsxs("button",{onClick:w,className:"inline-flex items-center px-3 py-2 text-sm bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Cancelar Multa"]})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(F,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Nenhuma multa foi aplicada a este processo"}),e.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Gerar Multa"]})]}),u&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Detalhes da Multa"}),e.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(A,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Valor"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 font-medium",children:L(a.valor)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsx("div",{className:"mt-1",children:N(a.pago)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Data de Emissão"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:C(a.data_emissao)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Data de Vencimento"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:C(a.data_vencimento)})]})]}),a.observacoes&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Observações"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.observacoes})]}),a.comprovante_pagamento&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Comprovante de Pagamento"}),e.jsxs("a",{href:a.comprovante_pagamento,target:"_blank",rel:"noopener noreferrer",className:"mt-1 inline-flex items-center text-sm text-blue-600 hover:text-blue-800",children:[e.jsx(S,{className:"w-4 h-4 mr-1"}),"Ver comprovante"]})]})]}),e.jsx("div",{className:"mt-6 flex justify-end space-x-3",children:e.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Fechar"})})]})}),d&&e.jsx($,{multa:{processo:c},onSave:b,onCancel:()=>p(!1)})]})}function se(){var j;const{id:c}=B();R();const[a,f]=x.useState(null),[g,r]=x.useState([]),[d,p]=x.useState(!0),[u,l]=x.useState(""),[h,b]=x.useState(!1),[v,w]=x.useState(""),[N,k]=x.useState(""),[m,y]=x.useState(!1);x.useEffect(()=>{_(),z()},[c]);const _=async()=>{try{p(!0);const t=await n.obterProcesso(c);f(t)}catch(t){console.error("❌ Erro ao carregar processo:",t),l("Erro ao carregar processo")}finally{p(!1)}},z=async()=>{try{const t=await n.listarDocumentos(c);r(t.results||[])}catch(t){console.error("❌ Erro ao carregar documentos:",t)}},s=async()=>{if(!v){alert("Selecione um novo status");return}y(!0);try{await n.alterarStatus(c,v,N),await _(),b(!1),w(""),k(""),alert("Status atualizado com sucesso!")}catch(t){console.error("❌ Erro ao atualizar status:",t),alert("Erro ao atualizar status: "+(t.message||"Erro desconhecido"))}finally{y(!1)}},i=t=>{const D=n.getCorStatus(t);return`bg-${D}-100 text-${D}-800 border-${D}-200`},o=(t,D,V="")=>e.jsxs("div",{className:`bg-gray-50 p-3 rounded ${V}`,children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:t}),e.jsx("p",{className:"text-gray-900",children:D||"-"})]});return d?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Carregando dossiê do processo..."})]})}):u||!a?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Erro ao carregar"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:u})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"bg-white shadow-sm rounded-lg mb-6",children:e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Processo ",a.numero_processo]}),e.jsx("p",{className:"text-gray-600 mt-1",children:a.autuado}),e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full border ${i(a.status)}`,children:a.status_display||a.status}),n.isPrazoVencido(a.prazo_defesa,a.status)&&e.jsxs("span",{className:"ml-2 inline-flex px-3 py-1 text-sm font-semibold rounded-full bg-red-100 text-red-800 border border-red-200",children:["⚠️ Prazo Vencido há ",Math.abs(n.calcularDiasRestantes(a.prazo_defesa))," dias"]})]})]}),e.jsx("div",{className:"flex space-x-3",children:e.jsxs("button",{onClick:()=>b(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Alterar Status"]})})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsx(P,{to:"/processos",className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"← Voltar para Lista de Processos"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Dados do Processo"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o("Número do Processo",a.numero_processo),o("Empresa Autuada",a.autuado),o("CNPJ",a.cnpj),o("Status",a.status),o("Prioridade",a.prioridade),o("Data de Abertura",n.formatarData(a.criado_em)),o("Prazo para Defesa",n.formatarData(a.prazo_defesa)),o("Valor da Multa",n.formatarValor(a.valor_multa))]})]}),a.auto_infracao&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Auto de Infração Originário"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o("Natureza da Infração",a.auto_infracao.relatorio),o("Data da Fiscalização",n.formatarData(a.auto_infracao.data_fiscalizacao)),o("Valor da Multa",n.formatarValor(a.auto_infracao.valor_multa)),o("Empresa",a.auto_infracao.razao_social),o("CNPJ",a.auto_infracao.cnpj),o("Local",a.auto_infracao.endereco)]}),e.jsx("div",{className:"mt-4",children:e.jsxs(P,{to:`/fiscalizacao/infracoes/${a.auto_infracao.id}`,className:"inline-flex items-center text-blue-600 hover:text-blue-800",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Ver Auto de Infração Completo"]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Documentos Anexados"}),g.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Nenhum documento anexado"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Adicione documentos relevantes ao processo."})]}):e.jsx("div",{className:"space-y-3",children:g.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-2xl",children:"📄"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.titulo}),e.jsx("p",{className:"text-xs text-gray-600",children:t.tipo_documento_display}),t.descricao&&e.jsx("p",{className:"text-xs text-gray-500",children:t.descricao}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Enviado em: ",n.formatarDataHora(t.enviado_em)]}),t.enviado_por&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Por: ",t.enviado_por_nome]})]})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsx("a",{href:t.arquivo,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm",children:"Visualizar"})})]},t.id))})]}),e.jsx(T,{processoId:c,onUploadSuccess:()=>{z(),alert("Documento enviado com sucesso!")},onUploadError:t=>{alert("Erro ao enviar documento: "+t)}}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsx(W,{historico:a.historico||[]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informações Rápidas"}),e.jsxs("div",{className:"space-y-3",children:[o("Data de Criação",n.formatarDataHora(a.criado_em)),o("Data Atualização",n.formatarDataHora(a.atualizado_em)),a.prazo_defesa&&o("Prazo para Defesa",n.formatarData(a.prazo_defesa)),a.prazo_recurso&&o("Prazo para Recurso",n.formatarData(a.prazo_recurso)),a.valor_multa&&o("Valor da Multa",n.formatarValor(a.valor_multa)),a.valor_final&&o("Valor Final",n.formatarValor(a.valor_final)),a.analista_responsavel&&o("Analista Responsável",a.analista_responsavel),a.fiscal_responsavel&&o("Fiscal Responsável",a.fiscal_responsavel)]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Estatísticas"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Documentos:"}),e.jsx("span",{className:"text-sm font-medium",children:g.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Histórico:"}),e.jsxs("span",{className:"text-sm font-medium",children:[((j=a.historico)==null?void 0:j.length)||0," eventos"]})]}),a.tempo_tramitacao&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Tempo de tramitação:"}),e.jsxs("span",{className:"text-sm font-medium",children:[a.tempo_tramitacao," dias"]})]}),a.status==="aguardando_defesa"&&a.prazo_defesa&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Dias restantes:"}),e.jsx("span",{className:`text-sm font-medium ${n.isPrazoVencido(a.prazo_defesa,a.status)?"text-red-600":"text-blue-600"}`,children:n.isPrazoVencido(a.prazo_defesa,a.status)?`Vencido há ${Math.abs(n.calcularDiasRestantes(a.prazo_defesa))} dias`:`${n.calcularDiasRestantes(a.prazo_defesa)} dias`})]})]})]}),e.jsx(I,{processoId:a.id})]})]}),h&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 text-center",children:"Alterar Status do Processo"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Novo Status"}),e.jsxs("select",{value:v,onChange:t=>w(t.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Selecione..."}),e.jsx("option",{value:"aguardando_defesa",children:"Aguardando Defesa"}),e.jsx("option",{value:"defesa_apresentada",children:"Defesa Apresentada"}),e.jsx("option",{value:"em_analise",children:"Em Análise"}),e.jsx("option",{value:"aguardando_recurso",children:"Aguardando Recurso"}),e.jsx("option",{value:"recurso_apresentado",children:"Recurso Apresentado"}),e.jsx("option",{value:"julgamento",children:"Em Julgamento"}),e.jsx("option",{value:"finalizado_procedente",children:"Finalizado - Procedente"}),e.jsx("option",{value:"finalizado_improcedente",children:"Finalizado - Improcedente"}),e.jsx("option",{value:"arquivado",children:"Arquivado"}),e.jsx("option",{value:"prescrito",children:"Prescrito"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),e.jsx("textarea",{value:N,onChange:t=>k(t.target.value),placeholder:"Motivo da alteração ou observações...",rows:3,className:"w-full p-2 border border-gray-300 rounded-md"})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>b(!1),className:"flex-1 px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Cancelar"}),e.jsx("button",{onClick:s,disabled:m||!v,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400",children:m?"Atualizando...":"Confirmar"})]})]})})})]})})}export{se as default};
