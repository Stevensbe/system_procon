import{j as e,L as I}from"./main-DVdFXPbZ.js";import{r as n}from"./router-C15yhWin.js";import{c as y}from"./cobrancaService-y4NTKzV9.js";import{a as z,f as B}from"./formatters-Ck8j3q9a.js";import{n as l}from"./index-CsOmCsbp.js";import{F as v}from"./PlusIcon-DZYmRjce.js";import{F as L}from"./MagnifyingGlassIcon-DxjVcYIb.js";import{F as q}from"./FunnelIcon-PU3yDtaQ.js";import{F as g}from"./ArrowUpIcon-DJBdd_VW.js";import{F as h}from"./ArrowDownIcon-CZdQ6zPL.js";import{F as G}from"./EyeIcon-Cu0Wnbis.js";import{F as j}from"./DocumentArrowDownIcon-Bp61FGwk.js";import{F}from"./DocumentArrowUpIcon-DBsAc1ml.js";import{F as R}from"./ClockIcon-CbdR_WDb.js";import{F as T}from"./XCircleIcon-BTR4Rsg8.js";import{F as D}from"./ExclamationTriangleIcon-Y0luX6t1.js";import{F as M}from"./CheckCircleIcon-B-MrGrlS.js";import"./vendor-Csw2ODfV.js";import"./icons-C8WIGuh4.js";const ce=()=>{const[d,u]=n.useState([]),[b,N]=n.useState(!0),[w,C]=n.useState(""),[i,S]=n.useState({status:"",banco:"",dataInicio:"",dataFim:""}),[o,k]=n.useState({field:"data_geracao",direction:"desc"}),[s,m]=n.useState({page:1,pageSize:20,totalPages:1,totalItems:0});n.useEffect(()=>{x()},[s.page,s.pageSize,o,i]);const x=async()=>{try{N(!0);const a={page:s.page,page_size:s.pageSize,search:w,filters:i,sorting:o},t=await y.getRemessas(a);t&&t.data?(u(Array.isArray(t.data)?t.data:[]),m(r=>({...r,totalPages:t.totalPages||1,totalItems:t.totalItems||0}))):u([])}catch(a){console.error("Erro ao carregar remessas:",a),l.error("Erro ao carregar remessas"),u([])}finally{N(!1)}},P=a=>{a.preventDefault(),m(t=>({...t,page:1})),x()},f=(a,t)=>{S(r=>({...r,[a]:t})),m(r=>({...r,page:1}))},p=a=>{k(t=>({field:a,direction:t.field===a&&t.direction==="asc"?"desc":"asc"}))},c=a=>{m(t=>({...t,page:a}))},$=a=>{switch(a==null?void 0:a.toLowerCase()){case"pendente":return"text-yellow-600 bg-yellow-100";case"gerado":return"text-blue-600 bg-blue-100";case"enviado":return"text-purple-600 bg-purple-100";case"processado":return"text-green-600 bg-green-100";case"erro":return"text-red-600 bg-red-100";case"cancelado":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}},_=a=>{switch(a==null?void 0:a.toLowerCase()){case"pendente":return e.jsx(R,{className:"w-4 h-4"});case"gerado":return e.jsx(j,{className:"w-4 h-4"});case"enviado":return e.jsx(F,{className:"w-4 h-4"});case"processado":return e.jsx(M,{className:"w-4 h-4"});case"erro":return e.jsx(D,{className:"w-4 h-4"});case"cancelado":return e.jsx(T,{className:"w-4 h-4"});default:return e.jsx(R,{className:"w-4 h-4"})}},A=async a=>{try{await y.gerarRemessa(a),l.success("Remessa gerada com sucesso!"),x()}catch(t){console.error("Erro ao gerar remessa:",t),l.error("Erro ao gerar remessa")}},E=async a=>{try{await y.processarRetorno(a),l.success("Retorno processado com sucesso!"),x()}catch(t){console.error("Erro ao processar retorno:",t),l.error("Erro ao processar retorno")}};return b&&d.length===0?e.jsx(I,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Remessas Bancárias"}),e.jsx("p",{className:"text-gray-600",children:"Gestão de arquivos de remessa e retorno CNAB"})]}),e.jsx("div",{className:"flex space-x-3",children:e.jsxs("button",{className:"btn-primary",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Nova Remessa"]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar remessas...",value:w,onChange:a=>C(a.target.value),className:"pl-10 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("select",{value:i.status,onChange:a=>f("status",a.target.value),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Todos os Status"}),e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"gerado",children:"Gerado"}),e.jsx("option",{value:"enviado",children:"Enviado"}),e.jsx("option",{value:"processado",children:"Processado"}),e.jsx("option",{value:"erro",children:"Erro"}),e.jsx("option",{value:"cancelado",children:"Cancelado"})]}),e.jsx("input",{type:"date",value:i.dataInicio,onChange:a=>f("dataInicio",a.target.value),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"date",value:i.dataFim,onChange:a=>f("dataFim",a.target.value),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("button",{type:"submit",className:"btn-primary",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Filtrar"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[s.totalItems," remessas encontradas"]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>p("numero"),className:"flex items-center space-x-1 hover:text-gray-700",children:[e.jsx("span",{children:"Número"}),o.field==="numero"&&(o.direction==="asc"?e.jsx(g,{className:"w-4 h-4"}):e.jsx(h,{className:"w-4 h-4"}))]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Banco"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>p("quantidade_boletos"),className:"flex items-center space-x-1 hover:text-gray-700",children:[e.jsx("span",{children:"Boletos"}),o.field==="quantidade_boletos"&&(o.direction==="asc"?e.jsx(g,{className:"w-4 h-4"}):e.jsx(h,{className:"w-4 h-4"}))]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>p("valor_total"),className:"flex items-center space-x-1 hover:text-gray-700",children:[e.jsx("span",{children:"Valor Total"}),o.field==="valor_total"&&(o.direction==="asc"?e.jsx(g,{className:"w-4 h-4"}):e.jsx(h,{className:"w-4 h-4"}))]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>p("data_geracao"),className:"flex items-center space-x-1 hover:text-gray-700",children:[e.jsx("span",{children:"Data Geração"}),o.field==="data_geracao"&&(o.direction==="asc"?e.jsx(g,{className:"w-4 h-4"}):e.jsx(h,{className:"w-4 h-4"}))]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.isArray(d)&&d.map(a=>{var t,r;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.numero}),e.jsx("div",{className:"text-sm text-gray-500",children:a.tipo})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:((t=a.banco)==null?void 0:t.nome)||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:((r=a.banco)==null?void 0:r.codigo)||""})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.quantidade_boletos}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:z(a.valor_total)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:B(a.data_geracao)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${$(a.status)}`,children:[_(a.status),e.jsx("span",{className:"ml-1",children:a.status})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"text-indigo-600 hover:text-indigo-900",title:"Visualizar",children:e.jsx(G,{className:"w-4 h-4"})}),a.status==="pendente"&&e.jsx("button",{onClick:()=>A(a.id),className:"text-green-600 hover:text-green-900",title:"Gerar Remessa",children:e.jsx(j,{className:"w-4 h-4"})}),a.status==="enviado"&&e.jsx("button",{onClick:()=>E(a.id),className:"text-blue-600 hover:text-blue-900",title:"Processar Retorno",children:e.jsx(F,{className:"w-4 h-4"})})]})})]},a.id)})})]})}),s.totalPages>1&&e.jsx("div",{className:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>c(s.page-1),disabled:s.page===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),e.jsx("button",{onClick:()=>c(s.page+1),disabled:s.page===s.totalPages,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Próxima"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:(s.page-1)*s.pageSize+1})," a"," ",e.jsx("span",{className:"font-medium",children:Math.min(s.page*s.pageSize,s.totalItems)})," ","de ",e.jsx("span",{className:"font-medium",children:s.totalItems})," resultados"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>c(s.page-1),disabled:s.page===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),Array.from({length:Math.min(5,s.totalPages)},(a,t)=>{const r=t+1;return e.jsx("button",{onClick:()=>c(r),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${r===s.page?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:r},r)}),e.jsx("button",{onClick:()=>c(s.page+1),disabled:s.page===s.totalPages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Próxima"})]})})]})]})})]}),!b&&d.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Nenhuma remessa encontrada"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Comece criando uma nova remessa para gerenciar os arquivos CNAB."}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{className:"btn-primary",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Nova Remessa"]})})]})]})};export{ce as default};
