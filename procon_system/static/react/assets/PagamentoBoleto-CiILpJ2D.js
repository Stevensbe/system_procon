import{j as e}from"./main-BlGnCLHT.js";import{e as M,u as T,r as c,L as v}from"./router-C15yhWin.js";import{L as f}from"./LoadingSpinner-B1xxHhLi.js";import{u as V}from"./useNotification-Bm6NCblX.js";import{F as _}from"./ArrowLeftIcon-B1Aara0h.js";import{F as z}from"./BanknotesIcon-esZP9Qph.js";import{F as A}from"./CurrencyDollarIcon-rQfx65sT.js";import{F as G}from"./ExclamationTriangleIcon-Y0luX6t1.js";import{F as j}from"./PaperClipIcon-COa5Xtiy.js";import{F as H}from"./DocumentTextIcon-o9njoXYt.js";import{F as J}from"./CheckCircleIcon-B-MrGrlS.js";import"./vendor-Csw2ODfV.js";import"./icons-C8WIGuh4.js";const le=()=>{const{id:g}=M(),N=T(),[k,b]=c.useState(!1),[h,p]=c.useState(!1),[d,w]=c.useState(null),{showNotification:x}=V(),[r,m]=c.useState({dataPagamento:"",horaPagamento:"",valorPago:"",formaPagamento:"",instituicaoPagamento:"",numeroComprovante:"",observacoes:"",documentosComprovantes:[],descontos:0,juros:0,multa:0,taxas:0,valorLiquido:0}),[o,y]=c.useState({}),P=[{value:"dinheiro",label:"Dinheiro"},{value:"boleto_bancario",label:"Boleto Bancário"},{value:"transferencia_bancaria",label:"Transferência Bancária"},{value:"pix",label:"PIX"},{value:"cartao_credito",label:"Cartão de Crédito"},{value:"cartao_debito",label:"Cartão de Débito"},{value:"deposito_bancario",label:"Depósito Bancário"}],C=[{value:"banco_brasil",label:"Banco do Brasil"},{value:"itau",label:"Itaú Unibanco"},{value:"bradesco",label:"Bradesco"},{value:"santander",label:"Santander"},{value:"caixa",label:"Caixa Econômica Federal"},{value:"sicoob",label:"Sicoob"},{value:"sicredi",label:"Sicredi"},{value:"outras",label:"Outras Instituições"}];c.useEffect(()=>{F();const a=new Date,t=a.toISOString().split("T")[0],s=a.toTimeString().slice(0,5);m(n=>({...n,dataPagamento:t,horaPagamento:s}))},[g]);const F=async()=>{b(!0);try{await new Promise(t=>setTimeout(t,1e3));const a={id:parseInt(g),numero:"BOL-2024-001234",valor:1250.75,valorOriginal:1e3,dataVencimento:"2024-09-15",devedor:{nome:"Empresa ABC Ltda",cnpj:"12.345.678/0001-90"},processo:{numero:"2024001",assunto:"Prática Comercial Abusiva"}};w(a),m(t=>({...t,valorPago:a.valor.toFixed(2),valorLiquido:a.valor}))}catch{x("Erro ao carregar boleto","error")}finally{b(!1)}},l=(a,t)=>{if(m(s=>({...s,[a]:t})),o[a]&&y(s=>({...s,[a]:null})),["valorPago","descontos","juros","multa","taxas"].includes(a)){const s=parseFloat(a==="valorPago"?t:r.valorPago)||0,n=parseFloat(a==="descontos"?t:r.descontos)||0,L=parseFloat(a==="juros"?t:r.juros)||0,E=parseFloat(a==="multa"?t:r.multa)||0,I=parseFloat(a==="taxas"?t:r.taxas)||0,O=s-n+L+E+I;m(q=>({...q,valorLiquido:O}))}},$=()=>{const a={};return r.dataPagamento||(a.dataPagamento="Data de pagamento é obrigatória"),r.horaPagamento||(a.horaPagamento="Hora de pagamento é obrigatória"),r.valorPago?parseFloat(r.valorPago)<=0&&(a.valorPago="Valor deve ser maior que zero"):a.valorPago="Valor pago é obrigatório",r.formaPagamento||(a.formaPagamento="Forma de pagamento é obrigatória"),r.instituicaoPagamento||(a.instituicaoPagamento="Instituição de pagamento é obrigatória"),r.numeroComprovante.trim()||(a.numeroComprovante="Número do comprovante é obrigatório"),new Date(`${r.dataPagamento}T${r.horaPagamento}`)>new Date&&(a.dataPagamento="Data de pagamento não pode ser futura"),y(a),Object.keys(a).length===0},D=async a=>{if(a.preventDefault(),!$()){x("Corrija os erros no formulário","error");return}p(!0);try{await new Promise(t=>setTimeout(t,2e3)),x("Pagamento registrado com sucesso!","success"),N(`/cobranca/boletos/${g}`)}catch{x("Erro ao registrar pagamento","error")}finally{p(!1)}},B=a=>{const s=Array.from(a.target.files).map(n=>({id:Date.now()+Math.random(),name:n.name,size:n.size,type:n.type,file:n}));m(n=>({...n,documentosComprovantes:[...n.documentosComprovantes,...s]}))},R=a=>{m(t=>({...t,documentosComprovantes:t.documentosComprovantes.filter(s=>s.id!==a)}))},u=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a||0),S=()=>{const a=(d==null?void 0:d.valor)||0;return(r.valorLiquido||0)-a};if(k)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(f,{})});if(!d)return e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Boleto não encontrado."})});const i=S();return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(v,{to:`/cobranca/boletos/${g}`,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx(_,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Registrar Pagamento"}),e.jsxs("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:["Boleto ",d.numero]})]})]})}),e.jsxs("form",{onSubmit:D,className:"space-y-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center",children:[e.jsx(z,{className:"w-5 h-5 mr-2"}),"Informações do Boleto"]})}),e.jsx("div",{className:"p-6 bg-gray-50 dark:bg-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Número do Boleto"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white font-mono",children:d.numero})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Devedor"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:d.devedor.nome})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Valor Original"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:u(d.valor)})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center",children:[e.jsx(A,{className:"w-5 h-5 mr-2"}),"Dados do Pagamento"]})}),e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Data do Pagamento *"}),e.jsx("input",{type:"date",value:r.dataPagamento,onChange:a=>l("dataPagamento",a.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${o.dataPagamento?"border-red-500":"border-gray-300"}`}),o.dataPagamento&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.dataPagamento})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Hora do Pagamento *"}),e.jsx("input",{type:"time",value:r.horaPagamento,onChange:a=>l("horaPagamento",a.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${o.horaPagamento?"border-red-500":"border-gray-300"}`}),o.horaPagamento&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.horaPagamento})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Forma de Pagamento *"}),e.jsxs("select",{value:r.formaPagamento,onChange:a=>l("formaPagamento",a.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${o.formaPagamento?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Selecione a forma de pagamento"}),P.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]}),o.formaPagamento&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.formaPagamento})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Instituição de Pagamento *"}),e.jsxs("select",{value:r.instituicaoPagamento,onChange:a=>l("instituicaoPagamento",a.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${o.instituicaoPagamento?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Selecione a instituição"}),C.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]}),o.instituicaoPagamento&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.instituicaoPagamento})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Número do Comprovante/Documento *"}),e.jsx("input",{type:"text",value:r.numeroComprovante,onChange:a=>l("numeroComprovante",a.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${o.numeroComprovante?"border-red-500":"border-gray-300"}`,placeholder:"Ex: 123456789, DOC12345, TED98765"}),o.numeroComprovante&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.numeroComprovante})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Composição dos Valores"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Valor Pago *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:r.valorPago,onChange:a=>l("valorPago",a.target.value),className:`w-full pl-12 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white ${o.valorPago?"border-red-500":"border-gray-300"}`,placeholder:"0,00"})]}),o.valorPago&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.valorPago})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Descontos"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:r.descontos,onChange:a=>l("descontos",a.target.value),className:"w-full pl-12 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"0,00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Juros"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:r.juros,onChange:a=>l("juros",a.target.value),className:"w-full pl-12 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"0,00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Multa"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:r.multa,onChange:a=>l("multa",a.target.value),className:"w-full pl-12 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"0,00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Taxas"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:r.taxas,onChange:a=>l("taxas",a.target.value),className:"w-full pl-12 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"0,00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Valor Líquido"}),e.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded-md",children:e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:u(r.valorLiquido)})})]})]}),Math.abs(i)>.01&&e.jsx("div",{className:`p-4 rounded-md ${i>0?"bg-yellow-50 border border-yellow-200":"bg-red-50 border border-red-200"}`,children:e.jsxs("div",{className:"flex",children:[e.jsx(G,{className:`w-5 h-5 ${i>0?"text-yellow-400":"text-red-400"}`}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:`text-sm font-medium ${i>0?"text-yellow-800":"text-red-800"}`,children:i>0?"Pagamento a Maior":"Pagamento a Menor"}),e.jsxs("p",{className:`mt-2 text-sm ${i>0?"text-yellow-700":"text-red-700"}`,children:["Diferença de ",u(Math.abs(i))," em relação ao valor original do boleto."]})]})]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center",children:[e.jsx(j,{className:"w-5 h-5 mr-2"}),"Comprovantes de Pagamento"]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("input",{type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png",onChange:B,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Anexe comprovantes do pagamento (PDF, JPG, PNG)"})]}),r.documentosComprovantes.length>0&&e.jsx("div",{className:"space-y-2",children:r.documentosComprovantes.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(j,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(a.size/1024/1024).toFixed(2)," MB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>R(a.id),className:"text-red-600 hover:text-red-900",children:"Remover"})]},a.id))})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),"Observações"]})}),e.jsx("div",{className:"p-6",children:e.jsx("textarea",{value:r.observacoes,onChange:a=>l("observacoes",a.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"Observações sobre o pagamento"})})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(v,{to:`/cobranca/boletos/${g}`,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:h,className:"flex items-center px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?e.jsxs(e.Fragment,{children:[e.jsx(f,{size:"sm"}),e.jsx("span",{className:"ml-2",children:"Registrando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"w-5 h-5 mr-2"}),"Registrar Pagamento"]})})]})]})]})})};export{le as default};
