import{j as e}from"./main-BZolao6g.js";import{r as t,L as p}from"./router-Cgdj9vyr.js";import{a as i,F as T}from"./auditoriaService-ApqQ-Q7z.js";import{n as j}from"./index-CH3hczjV.js";import{F as B}from"./ArrowPathIcon-BEp-qGqs.js";import{F as f}from"./EyeIcon-xG4b5U4j.js";import{F as G}from"./DocumentTextIcon-B0GYMzL8.js";import{F as P}from"./ClockIcon-CMrA9XuO.js";import{F as d}from"./ExclamationTriangleIcon-2kHM3Vz3.js";import{R as N,B as O,C as U,X as q,Y as M,T as w,e as H,P as K,c as W,d as X}from"./charts-mbb-U41H.js";import{F as Y}from"./FunnelIcon-C9OgRzwO.js";import{F as y}from"./UserIcon-CLBajSSa.js";import{F as z}from"./ComputerDesktopIcon-r7QlwaM7.js";import{F as V}from"./CheckCircleIcon-DFajsejV.js";import{F as J}from"./CogIcon-DYKvQWLv.js";import{F as x}from"./InformationCircleIcon-BpFAM9LL.js";import"./vendor-Csw2ODfV.js";import"./icons-qiKTog5F.js";const pe=()=>{const[c,v]=t.useState({total_logs:0,logs_hoje:0,logs_mes:0,logs_criticos:0,logs_erro:0,logs_warning:0,logs_info:0}),[b,F]=t.useState([]),[m,R]=t.useState([]),[L,C]=t.useState([]),[k,h]=t.useState([]),[_,o]=t.useState(!0),[a,r]=t.useState({nivel:"",tipo_evento:"",usuario:"",data_inicio:"",data_fim:"",modulo:""});t.useEffect(()=>{n()},[]);const n=async()=>{try{o(!0);const s=await i.obterEstatisticas();v(s);const l=await i.obterLogsPorNivel();F(l);const I=await i.obterEventosFrequentes();R(I);const $=await i.obterLogsCriticos();C($);const D=await i.obterLogsRecentes();h(D)}catch(s){console.error("Erro ao carregar dados de auditoria:",s),j.error("Erro ao carregar dados de auditoria")}finally{o(!1)}},E=async()=>{try{o(!0);const s=await i.filtrarLogs(a);h(s)}catch(s){console.error("Erro ao aplicar filtros:",s),j.error("Erro ao aplicar filtros")}finally{o(!1)}},A=()=>{r({nivel:"",tipo_evento:"",usuario:"",data_inicio:"",data_fim:"",modulo:""}),n()},S=s=>{switch(s){case"CRITICAL":return"#dc2626";case"ERROR":return"#ea580c";case"WARNING":return"#d97706";case"INFO":return"#059669";case"DEBUG":return"#3b82f6";default:return"#6b7280"}},u=s=>{switch(s){case"CRITICAL":return e.jsx(T,{className:"h-5 w-5 text-red-600"});case"ERROR":return e.jsx(d,{className:"h-5 w-5 text-orange-600"});case"WARNING":return e.jsx(d,{className:"h-5 w-5 text-yellow-600"});case"INFO":return e.jsx(x,{className:"h-5 w-5 text-green-600"});case"DEBUG":return e.jsx(x,{className:"h-5 w-5 text-blue-600"});default:return e.jsx(x,{className:"h-5 w-5 text-gray-600"})}},g=s=>new Date(s).toLocaleString("pt-BR");return _?e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard de Auditoria"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Monitoramento e análise de logs do sistema"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:n,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Atualizar"]}),e.jsxs(p,{to:"/auditoria/logs",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Ver Todos os Logs"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(G,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total de Logs"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:c.total_logs.toLocaleString()})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(P,{className:"h-6 w-6 text-blue-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Logs Hoje"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:c.logs_hoje.toLocaleString()})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(d,{className:"h-6 w-6 text-red-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Logs Críticos"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:c.logs_criticos.toLocaleString()})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(d,{className:"h-6 w-6 text-orange-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Logs de Erro"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:c.logs_erro.toLocaleString()})]})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Logs por Nível (Últimos 30 dias)"}),e.jsx(N,{width:"100%",height:300,children:e.jsxs(O,{data:b,children:[e.jsx(U,{strokeDasharray:"3 3"}),e.jsx(q,{dataKey:"nivel"}),e.jsx(M,{}),e.jsx(w,{}),e.jsx(H,{dataKey:"count",fill:"#3b82f6"})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Eventos Mais Frequentes"}),e.jsx(N,{width:"100%",height:300,children:e.jsxs(K,{children:[e.jsx(W,{data:m,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,percent:l})=>`${s} ${(l*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"count",children:m.map((s,l)=>e.jsx(X,{fill:S(s.nivel)},`cell-${l}`))}),e.jsx(w,{})]})})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow mb-8",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filtros Avançados"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nível"}),e.jsxs("select",{value:a.nivel,onChange:s=>r({...a,nivel:s.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"CRITICAL",children:"Crítico"}),e.jsx("option",{value:"ERROR",children:"Erro"}),e.jsx("option",{value:"WARNING",children:"Aviso"}),e.jsx("option",{value:"INFO",children:"Info"}),e.jsx("option",{value:"DEBUG",children:"Debug"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Usuário"}),e.jsx("input",{type:"text",value:a.usuario,onChange:s=>r({...a,usuario:s.target.value}),placeholder:"Filtrar por usuário",className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Início"}),e.jsx("input",{type:"date",value:a.data_inicio,onChange:s=>r({...a,data_inicio:s.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Fim"}),e.jsx("input",{type:"date",value:a.data_fim,onChange:s=>r({...a,data_fim:s.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Módulo"}),e.jsx("input",{type:"text",value:a.modulo,onChange:s=>r({...a,modulo:s.target.value}),placeholder:"Filtrar por módulo",className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsxs("button",{onClick:E,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Aplicar"]}),e.jsx("button",{onClick:A,className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400",children:"Limpar"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-8",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Logs Críticos Recentes"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nível"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ação"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"IP"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data/Hora"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:L.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[u(s.nivel),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-900",children:s.nivel})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:s.acao}),e.jsx("div",{className:"text-sm text-gray-500",children:s.descricao})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.usuario||"Sistema"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.ip_origem||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g(s.timestamp)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.sucesso?e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(V,{className:"h-3 w-3 mr-1"}),"Sucesso"]}):e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[e.jsx(d,{className:"h-3 w-3 mr-1"}),"Erro"]})})]},s.id))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Logs Recentes"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nível"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ação"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Módulo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data/Hora"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[u(s.nivel),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-900",children:s.nivel})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:s.acao}),e.jsx("div",{className:"text-sm text-gray-500",children:s.descricao})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.usuario||"Sistema"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.modulo||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g(s.timestamp)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx(p,{to:`/auditoria/logs/${s.id}`,className:"text-blue-600 hover:text-blue-900",children:e.jsx(f,{className:"h-4 w-4"})})})]},s.id))})]})})]})]})};export{pe as default};
